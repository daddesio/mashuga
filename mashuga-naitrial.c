/*
** mashuga, a proof-of-concept city server for The Sims Online (N&I) - mashuga-naitrial.c
** Authors: Andrew D'Addesio <andrew@fatbag.net>
** License: Public domain
** Compile: gcc -Wall -Wextra -Wno-unused-parameter -Wno-unused-function -ansi -pedantic -Os -g0 -s
**	-static-libgcc -o mashuga-naitrial.exe mashuga-naitrial.c -levent_openssl -levent -lcrypto
**	-lssl -lws2_32
**
** mashuga is a proof-of-concept city server for The Sims Online for use with
** the HouseSimServer. It has a hardcoded city (Blazing Falls), lot (JollyLot),
** and player (JollySim). Support for multiple players at a time is not
** supported in mashuga but is mostly supported in our HouseSimServer patch.
**
** A complete city server implementation should read the lots, players, etc.
** from a database, as well as spawn and manage HouseSimServer processes
** (one per running lot).
**
** Usage:
** 1. Run mashuga-naitrial.exe.
** 2. Start one copy of TSO in HouseSimServer mode (requires a patch) using the command line:
**	TSOClient.exe -w -debug_objects -playerid:1200 -vport:49101 -vhost:"localhost" -city:1
** 3. Start another copy of TSO in client mode using: "TSOClient.exe -w -debug_objects".
*/
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#ifdef _WIN32
 #include <winsock2.h>
 #define close closesocket
 static WSADATA wsaData;
#else
 #include <unistd.h>
 #include <sys/socket.h>
 #include <netinet/in.h>
 #include <netinet/tcp.h>
 #include <arpa/inet.h>
#endif

#include <openssl/ssl.h>
#include <openssl/err.h>
#include <openssl/evp.h>
#include <openssl/conf.h>
#include <event2/event.h>
#include <event2/listener.h>
#include <event2/buffer.h>
#include <event2/bufferevent_ssl.h>

#define MAX(x,y) ((x)>(y)?(x):(y))
#define MAX_ARIES_PACKET_SIZE 32768
#define MAX_ARIES_PAYLOAD_SIZE (MAX_ARIES_PACKET_SIZE-12)
#define READ32LE(x) ((uint32_t)((x)[0]|((x)[1]<<8)|((x)[2]<<16)|((x)[3]<<24)))
#define READ32BE(x) ((uint32_t)(((x)[0]<<24)|((x)[1]<<16)|((x)[2]<<8)|(x)[3]))
#define READ16LE(x) ((uint16_t)((x)[0]|((x)[1]<<8)))
#define READ16BE(x) ((uint16_t)(((x)[0]<<8)|(x)[1]))
#define WRITE32LE(d,s) (d)[0]=(s)&0xFF,(d)[1]=((s)>>8)&0xFF, \
	(d)[2]=((s)>>16)&0xFF,(d)[3]=((s)>>24)&0xFF
#define WRITE32BE(d,s) (d)[0]=((s)>>24)&0xFF,(d)[1]=((s)>>16)&0xFF, \
	(d)[2]=((s)>>8)&0xFF,(d)[3]=(s)&0xFF
#define WRITE16LE(d,s) (d)[0]=(s)&0xFF,(d)[1]=((s)>>8)&0xFF
#define WRITE16BE(d,s) (d)[0]=((s)>>8)&0xFF,(d)[1]=(s)&0xFF

struct Server {
	FILE *logfp;
	SSL_CTX *ctx;
};

struct Client {
	const char *name;
	uint32_t avatarid;
	uint8_t is_roomserver;
	uint8_t is_connected;
	uint8_t is_joined;
	SSL *ctx;
	struct bufferevent *bev;
};

static struct Server server = {0};
static struct Client roomserver = {0};
static struct Client player = {0};

struct ByteStream {
	uint8_t *data;
	uint32_t size;
	uint32_t position;
};

static uint8_t bytestream_read8(struct ByteStream *stream)
{
	if (stream->size - stream->position < 1)
		return 0;

	return stream->data[stream->position++];
}

static uint16_t bytestream_read16be(struct ByteStream *stream)
{
	uint16_t value;
	if (stream->size - stream->position < 2) {
		stream->position = stream->size;
		return 0;
	}

	value = READ16BE(stream->data+stream->position);
	stream->position += 2;
	return value;
}

static uint32_t bytestream_read32be(struct ByteStream *stream)
{
	uint16_t value;
	if (stream->size - stream->position < 4) {
		stream->position = stream->size;
		return 0;
	}

	value = READ32BE(stream->data+stream->position);
	stream->position += 4;
	return value;
}

static void bytestream_write8(struct ByteStream *stream, uint8_t value)
{
	if (stream->size - stream->position < 1)
		return;

	stream->data[stream->position++] = value;
}

static void bytestream_write16be(struct ByteStream *stream, uint16_t value)
{
	if (stream->size - stream->position < 2) {
		memset(stream->data+stream->position, 0, stream->size - stream->position);
		stream->position = stream->size;
		return;
	}

	WRITE16BE(stream->data+stream->position, value);
	stream->position += 2;
}

static void bytestream_write32be(struct ByteStream *stream, uint32_t value)
{
	if (stream->size - stream->position < 4) {
		memset(stream->data+stream->position, 0, stream->size - stream->position);
		stream->position = stream->size;
		return;
	}

	WRITE32BE(stream->data+stream->position, value);
	stream->position += 4;
}

static void bytestream_skip(struct ByteStream *stream, unsigned byte_count)
{
	if (stream->size - stream->position < byte_count)
		stream->position = stream->size;
	else
		stream->position += byte_count;
}

static void client_handle_house_sim_constraints_pdu(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x48,0x1A,0x00,0x00,

		/* HouseSimConstraintsResponsePDU */
		0x27,0x26,
		0x00,0x00,0x00,0x0A,
		0xFE,0xED,0xF0,0x0D,

		/* HouseData */
		0x27,0x12,
		0x00,0x00,0x1A,0x3E,
		0xFE,0xED,0xF0,0x0D,
		0x80,0x00,0x00,0x00,
		0x80,0x00,0x00,0x00,
		0x01,
		0x01,
		0x00,0x00,0x1A,0x26,
		0x12,0x51,0x94,0xE5,
		0xFF,0xFF,0xFF,0xFF,
		0xFE,0xED,0xF0,0x0D,
		0xFF,
		0x9B,0x7E,0xD6,0x31,
		0x00,0x00,0x00,0x02,
		0x00,0x00,0x00,0x02,
		0x00,0x00,0x00,0x02,
		0xDB,0xB9,0x12,0x6C,
		0x00,
		0x00,0x00,0x19,0xFB,
		0x5F,0x53,0x41,0x52,0xFB,0x19,0x00,0x00,0x04,0x00,0x00,0x00,0x5F,0x43,0x4F,0x54,
		0x20,0x00,0x5F,0x72,0x65,0x76,0x00,0x00,0x00,0x00,0xD2,0x01,0x00,0x00,0x00,0x00,
		0x65,0x76,0x61,0x73,0x01,0x00,0x00,0x00,0xE2,0x01,0x00,0x00,0x00,0x00,0x5F,0x4D,
		0x49,0x53,0x00,0x00,0x00,0x00,0xFA,0x01,0x00,0x00,0x01,0x00,0x44,0x4C,0x52,0x57,
		0x01,0x00,0x00,0x00,0x3C,0x02,0x00,0x00,0x01,0x00,0x49,0x4C,0x45,0x53,0x00,0x00,
		0x00,0x00,0xEE,0x14,0x00,0x00,0x00,0x00,0x49,0x4C,0x45,0x53,0x01,0x00,0x00,0x00,
		0x0C,0x15,0x00,0x00,0x00,0x00,0x49,0x4C,0x45,0x53,0x02,0x00,0x00,0x00,0x2A,0x15,
		0x00,0x00,0x00,0x00,0x49,0x4C,0x45,0x53,0x03,0x00,0x00,0x00,0x48,0x15,0x00,0x00,
		0x00,0x00,0x49,0x4C,0x45,0x53,0x04,0x00,0x00,0x00,0x66,0x15,0x00,0x00,0x00,0x00,
		0x49,0x4A,0x42,0x4F,0x00,0x00,0x00,0x00,0x84,0x15,0x00,0x00,0x00,0x00,0x5F,0x4A,
		0x42,0x4F,0x07,0x00,0x00,0x00,0x9A,0x15,0x00,0x00,0x01,0x00,0x50,0x6A,0x62,0x6F,
		0x07,0x00,0x00,0x00,0x2F,0x16,0x00,0x00,0x00,0x00,0x49,0x4A,0x42,0x4F,0x01,0x00,
		0x00,0x00,0x41,0x16,0x00,0x00,0x00,0x00,0x5F,0x4A,0x42,0x4F,0x06,0x00,0x00,0x00,
		0x57,0x16,0x00,0x00,0x01,0x00,0x50,0x6A,0x62,0x6F,0x06,0x00,0x00,0x00,0xEC,0x16,
		0x00,0x00,0x00,0x00,0x49,0x4A,0x42,0x4F,0x02,0x00,0x00,0x00,0xFE,0x16,0x00,0x00,
		0x00,0x00,0x5F,0x4A,0x42,0x4F,0x05,0x00,0x00,0x00,0x14,0x17,0x00,0x00,0x01,0x00,
		0x50,0x6A,0x62,0x6F,0x05,0x00,0x00,0x00,0xB1,0x17,0x00,0x00,0x00,0x00,0x49,0x4A,
		0x42,0x4F,0x03,0x00,0x00,0x00,0xC3,0x17,0x00,0x00,0x00,0x00,0x5F,0x4A,0x42,0x4F,
		0x04,0x00,0x00,0x00,0xD9,0x17,0x00,0x00,0x01,0x00,0x50,0x6A,0x62,0x6F,0x04,0x00,
		0x00,0x00,0x7A,0x18,0x00,0x00,0x00,0x00,0x49,0x4A,0x42,0x4F,0x04,0x00,0x00,0x00,
		0x8C,0x18,0x00,0x00,0x00,0x00,0x5F,0x4A,0x42,0x4F,0x03,0x00,0x00,0x00,0xA2,0x18,
		0x00,0x00,0x01,0x00,0x50,0x6A,0x62,0x6F,0x03,0x00,0x00,0x00,0x44,0x19,0x00,0x00,
		0x00,0x00,0x44,0x4F,0x4D,0x4F,0x01,0x00,0x00,0x00,0x56,0x19,0x00,0x00,0x00,0x00,
		0x52,0x47,0x4D,0x46,0x00,0x00,0x00,0x00,0x6D,0x19,0x00,0x00,0x00,0x00,0x52,0x47,
		0x4D,0x57,0x00,0x00,0x00,0x00,0x7D,0x19,0x00,0x00,0x00,0x00,0x44,0x49,0x53,0x48,
		0x00,0x00,0x00,0x00,0x8D,0x19,0x00,0x00,0x00,0x00,0x43,0x53,0x44,0x48,0x00,0x00,
		0x00,0x00,0xA2,0x19,0x00,0x00,0x00,0x00,0x54,0x4D,0x52,0x48,0x00,0x00,0x00,0x00,
		0xB8,0x19,0x00,0x00,0x00,0x00,0x45,0x54,0x52,0x48,0x00,0x00,0x00,0x00,0xCC,0x19,
		0x00,0x00,0x01,0x00,0x4E,0x42,0x4D,0x41,0x00,0x00,0x00,0x00,0xEB,0x19,0x00,0x00,
		0x00,0x00,0x5F,0x72,0x65,0x76,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x02,0x00,
		0x00,0x00,0x65,0x76,0x61,0x73,0x01,0x00,0x00,0x00,0x0C,0x00,0x00,0x00,0x03,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x5F,0x4D,0x49,0x53,0x00,0x00,
		0x00,0x00,0x36,0x00,0x00,0x00,0x56,0x00,0x00,0x00,0x32,0x00,0x00,0x00,0x10,0xFB,
		0x00,0x00,0x56,0xE0,0x01,0x00,0x0F,0x00,0x03,0x01,0x01,0x00,0x02,0x04,0x00,0xE0,
		0x06,0x00,0xCD,0x07,0x08,0x08,0x10,0x00,0x0B,0x07,0x01,0x00,0x15,0x0C,0x1D,0x03,
		0x11,0x00,0x00,0x40,0x88,0x40,0x20,0x04,0x93,0x00,0x00,0xFC,0x44,0x4C,0x52,0x57,
		0x01,0x00,0x00,0x00,0xA6,0x12,0x00,0x00,0xF0,0x27,0x00,0x00,0xA2,0x12,0x00,0x00,
		0x10,0xFB,0x00,0x27,0xF0,0xE0,0x00,0x00,0x40,0x00,0x0C,0x03,0x01,0x03,0x04,0xE2,
		0x0E,0x00,0x07,0x00,0x07,0x07,0x38,0x00,0x20,0x20,0x20,0x1C,0x04,0x00,0x00,0x06,
		0x04,0x08,0x00,0x03,0x04,0x10,0x04,0x0C,0x00,0x19,0x04,0x1C,0x0C,0x03,0x14,0x18,
		0x18,0x21,0xE2,0x3A,0x80,0xFF,0x8D,0x01,0x01,0xFF,0xF8,0x7F,0xFC,0xFF,0xFF,0x01,
		0x4F,0x1F,0xE0,0x00,0xF8,0xFF,0xFF,0x05,0x07,0x0F,0xE0,0xF0,0xFF,0xFF,0x07,0x04,
		0x07,0xE0,0xE0,0xFF,0xFF,0x03,0x04,0x07,0xE0,0xC0,0xFF,0xFF,0x01,0x04,0x07,0x07,
		0x06,0x80,0xFF,0xFF,0x95,0x80,0x07,0x00,0x00,0x0D,0x07,0x7F,0xAC,0x40,0x07,0xFE,
		0x9C,0x00,0x57,0xB4,0x00,0x77,0xBC,0x00,0x57,0xBC,0x00,0xEF,0x38,0x37,0x34,0x47,
		0x34,0x57,0x34,0x67,0x34,0x77,0x29,0x87,0xFF,0x06,0x30,0x39,0x80,0xE2,0x3E,0x80,
		0x01,0x01,0x00,0x02,0x50,0x81,0x01,0x14,0x00,0x03,0x0D,0x00,0x04,0x0A,0x00,0x05,
		0x01,0x04,0x0E,0xE0,0x05,0x0A,0x80,0x01,0x0D,0x18,0x06,0xE0,0x05,0x18,0x80,0x01,
		0x09,0x0A,0x0E,0x0E,0x27,0x06,0x08,0xE3,0x06,0x08,0x0A,0x80,0x04,0x02,0x00,0x06,
		0x09,0x17,0x80,0x01,0x04,0x00,0x03,0x06,0x17,0x08,0x08,0x05,0x15,0x15,0x08,0x13,
		0x15,0x08,0x11,0x15,0x08,0x0F,0xE0,0x0E,0x80,0x01,0x02,0x8A,0xC0,0x06,0x00,0x0A,
		0x09,0x15,0x1D,0x0D,0x0D,0x0F,0x0C,0xA9,0x00,0x06,0xE0,0x04,0x00,0x0B,0x02,0x02,
		0x42,0x00,0x0C,0x8E,0x00,0x57,0xB2,0x00,0x6C,0xAC,0x00,0x50,0xC0,0x00,0x6C,0x41,
		0x0C,0x08,0x28,0x27,0x04,0x08,0x28,0x39,0x04,0x08,0x28,0x4B,0x04,0x08,0x28,0x5D,
		0x04,0x08,0x20,0x6F,0xE1,0x0E,0x00,0x0B,0x0D,0x0D,0x0D,0x02,0x00,0x00,0x04,0x08,
		0x07,0x02,0x04,0x0A,0x80,0xE0,0x02,0x09,0x1C,0x80,0x20,0xC7,0x04,0x19,0x04,0x00,
		0x2D,0xC7,0x0C,0x04,0x0E,0x29,0xC7,0x0C,0x08,0x18,0x23,0xF1,0x0C,0x4C,0x81,0x21,
		0xF7,0x08,0x20,0xBA,0x7D,0xE4,0xAD,0x01,0x03,0x02,0x48,0x40,0x08,0x09,0x12,0x16,
		0x00,0x82,0x04,0x03,0x19,0x1A,0x0E,0x8A,0x80,0x19,0x0E,0x80,0x04,0x2A,0x01,0x03,
		0x06,0x03,0x05,0x05,0x00,0x0C,0x03,0x09,0x03,0x00,0x04,0xE1,0x06,0x00,0x07,0x00,
		0x54,0x80,0x00,0x09,0x0E,0x33,0x00,0x11,0xE0,0x00,0x01,0x08,0x80,0x00,0x3E,0x03,
		0x1C,0x01,0x9A,0x81,0xE0,0x01,0x02,0x03,0x04,0x1D,0x3F,0x05,0x08,0x21,0x8B,0x40,
		0x50,0x90,0xB1,0x00,0x85,0x93,0x00,0x34,0x8D,0x00,0x60,0x08,0x10,0xFB,0x10,0xF8,
		0xFA,0xF5,0xEF,0xF3,0xF7,0xF4,0xF7,0xF8,0xFD,0xFB,0x09,0x12,0x0A,0x07,0x0D,0x0D,
		0x07,0x08,0x07,0x08,0x06,0x03,0xFF,0xFE,0xFE,0xF7,0xF7,0xFF,0xFF,0xFD,0x00,0xFE,
		0x00,0x0A,0x0C,0x08,0x0D,0x16,0x18,0x14,0x1C,0x20,0x1D,0x1B,0x12,0x06,0x00,0xFD,
		0xFD,0xF4,0xF5,0xFE,0xFC,0x01,0xF6,0xF5,0xF5,0xFC,0x02,0x05,0x05,0x03,0xFF,0xF5,
		0xF7,0xFE,0xFA,0xF7,0xF7,0xF5,0xF4,0xFA,0xF5,0xFF,0x09,0x12,0x09,0x06,0x0F,0x14,
		0x12,0x0E,0x16,0x11,0x0E,0x07,0x02,0xFE,0x00,0xFF,0x02,0x07,0x06,0x09,0x05,0x07,
		0x03,0x08,0x09,0x04,0x0A,0x11,0x14,0x24,0x21,0x24,0x21,0x20,0x18,0x10,0xE6,0x0A,
		0x05,0x03,0x04,0x02,0x03,0x00,0x05,0xFD,0xF1,0xF8,0xF2,0xF7,0x04,0xFB,0xFB,0xF8,
		0xF5,0xF5,0xFF,0xF9,0xF4,0xFD,0x00,0xF7,0xF5,0xFC,0xFD,0x03,0x28,0x08,0x16,0x0B,
		0xFB,0x17,0x1C,0x18,0x1D,0x12,0x12,0x0F,0x07,0x08,0x05,0x02,0x07,0x0D,0x10,0x0C,
		0x10,0x10,0x0A,0x03,0xFC,0x01,0x0D,0x1C,0x2D,0x2A,0x2A,0x2D,0x2A,0x22,0x25,0x17,
		0x12,0x12,0x19,0x13,0x0A,0x0C,0x0A,0xFC,0xF1,0xED,0xF1,0xF6,0xFD,0xFA,0xF0,0xEF,
		0xF7,0xF7,0xF9,0x00,0xFC,0x04,0x04,0xFF,0xF3,0x01,0x03,0x0C,0x19,0x0E,0x0C,0x10,
		0x15,0x15,0x1C,0x1B,0x24,0x20,0x17,0x0D,0x08,0x0A,0x07,0x08,0x0B,0x0E,0x0D,0x0F,
		0x12,0x0E,0x11,0x05,0x03,0x08,0x1C,0x23,0x36,0x30,0x2E,0x2F,0x2D,0x2A,0x28,0x21,
		0x1F,0x1A,0x1B,0x15,0x0F,0x0A,0x0E,0xFC,0xFB,0xFD,0xF8,0xFA,0xF2,0xF3,0xEE,0xF5,
		0xF5,0xFB,0xF3,0xF9,0x05,0x09,0x02,0x06,0xFE,0xF6,0x02,0x0C,0x11,0x14,0x0C,0x0D,
		0x14,0x17,0x1E,0x20,0x1F,0x23,0x1D,0x1E,0x12,0x11,0x13,0x11,0x15,0x18,0x15,0x10,
		0x0F,0x10,0x13,0x11,0x09,0x03,0x14,0x27,0x33,0x3B,0x34,0x33,0x2F,0x36,0x38,0x33,
		0x35,0x30,0x24,0x1C,0x16,0x16,0x10,0x0B,0x03,0x01,0x01,0xFE,0xF1,0xED,0xEA,0xE7,
		0xEE,0xFB,0xFE,0xFB,0xFD,0xFD,0xFA,0x02,0xF8,0xFC,0x04,0x13,0x14,0x19,0x12,0x0D,
		0x19,0x22,0x24,0x1F,0x23,0x23,0x20,0x1F,0x1E,0x1C,0x1A,0x0E,0x12,0x11,0x11,0x0E,
		0x10,0x07,0x05,0x0D,0x0B,0x09,0x18,0x21,0x2F,0x40,0x36,0x35,0x3A,0x38,0x37,0x34,
		0x32,0x39,0xE0,0x28,0x21,0x15,0x17,0x21,0x68,0x11,0xE2,0x03,0xFE,0xF3,0xED,0xEC,
		0xF1,0xF6,0xFA,0xFC,0x01,0xFB,0xF5,0x21,0x7D,0xF5,0xE4,0x0A,0x13,0x14,0x1A,0x15,
		0x18,0x27,0x31,0x2A,0x27,0x26,0x1D,0x25,0x2B,0x27,0x26,0x1A,0x11,0x0B,0x10,0x43,
		0x24,0x11,0x0D,0x0A,0xFB,0x05,0x0D,0x14,0x22,0x2F,0x3F,0x43,0x3F,0x40,0x3F,0x3F,
		0x39,0x42,0x43,0x33,0x22,0x1E,0x13,0x10,0x0F,0x12,0x13,0x08,0x06,0xF9,0xEE,0xFB,
		0x01,0xFC,0x02,0x02,0xFC,0xF9,0xF0,0xFD,0x02,0xFB,0x01,0x09,0x10,0x15,0x1E,0x18,
		0x1B,0x29,0x34,0x2F,0x28,0x28,0x26,0x2D,0x2B,0x2D,0x27,0x21,0x17,0x0F,0x0C,0x0B,
		0x06,0x05,0x05,0x01,0x0B,0x0F,0x0C,0x17,0x2A,0x32,0x3C,0x43,0x47,0x42,0x40,0x3E,
		0x3E,0x44,0x48,0x3B,0x2C,0x27,0x1E,0x17,0x1A,0x14,0x13,0x11,0x07,0x00,0xF6,0xFA,
		0x07,0x06,0x05,0xFD,0xFB,0xF9,0xF5,0xFE,0x04,0x08,0x04,0x06,0x0C,0x11,0x1B,0x1D,
		0x28,0x2E,0x39,0x33,0x27,0xF2,0x23,0x28,0x30,0x34,0x36,0x32,0x2C,0x21,0x18,0x07,
		0x09,0x04,0x06,0x01,0x07,0x0A,0x0D,0x12,0x1A,0x2A,0x37,0x43,0x49,0x48,0x3E,0x3C,
		0x3B,0x43,0x3F,0x45,0x44,0x3B,0x2A,0x24,0x24,0x25,0x18,0x15,0x0F,0x0F,0x07,0x00,
		0xFF,0x09,0x06,0x12,0x0D,0x12,0x09,0x04,0x09,0x15,0x11,0x12,0x18,0x15,0x1C,0x1F,
		0x21,0x2A,0x31,0x39,0x3B,0x36,0x2C,0x28,0x34,0x32,0x30,0x31,0x2D,0x20,0x16,0x0E,
		0x0C,0x09,0x01,0xC4,0x09,0xFB,0x17,0x1D,0x1F,0x2B,0x35,0x3D,0x42,0x49,0x43,0x3B,
		0x48,0x4A,0x4D,0x46,0x42,0x39,0x33,0x2C,0x2B,0x20,0x1F,0x1F,0x1A,0x15,0x12,0x14,
		0x11,0x19,0x17,0x26,0x20,0x21,0x19,0x1B,0x20,0x23,0x1F,0x25,0x25,0x1E,0x21,0x25,
		0x2D,0x31,0x33,0x3E,0x42,0x3F,0x38,0x31,0x34,0x35,0x36,0x3B,0x28,0x20,0x1C,0x13,
		0x0A,0x0B,0x0F,0x0D,0x17,0x23,0x1E,0x24,0x25,0x30,0x37,0x3B,0x41,0x46,0x40,0x3F,
		0x4B,0x54,0x4D,0x51,0x42,0x3D,0x32,0x32,0x25,0x23,0x28,0x2D,0x25,0x15,0x1D,0x20,
		0x1B,0x21,0x25,0x2B,0x32,0x27,0x28,0x27,0x2C,0x25,0x29,0x33,0x28,0x25,0x2A,0x2F,
		0x33,0x31,0x35,0x3D,0x3C,0x3D,0xEA,0x3D,0x31,0x38,0x30,0x33,0x32,0x2D,0x25,0x1A,
		0x1B,0x18,0x1D,0x1B,0x18,0x1F,0x27,0x26,0x2D,0x2D,0x3D,0x3A,0x3F,0x3B,0x40,0x44,
		0x42,0x4C,0x53,0x59,0x5B,0x4E,0x4C,0x3D,0x3D,0x30,0x2D,0x2E,0x32,0x2C,0x22,0x2A,
		0x25,0x23,0x23,0x02,0xEA,0x2D,0x3B,0x03,0xB6,0x36,0x2D,0x2F,0xFB,0x31,0x36,0x37,
		0x3D,0x3B,0x38,0x3F,0x40,0x3D,0x37,0x3C,0x3A,0x34,0x2E,0x33,0x2A,0x2B,0x27,0x1C,
		0x20,0x2B,0x29,0x29,0x2D,0x33,0x35,0x32,0x35,0x42,0x46,0x43,0x40,0x3D,0x43,0x48,
		0x4E,0x51,0x57,0x66,0x5B,0x5A,0x50,0x42,0x3F,0x3B,0x3B,0x37,0x38,0x38,0x34,0x2E,
		0x2E,0x2B,0x37,0x46,0x40,0x3B,0x3C,0x34,0x39,0x3D,0x38,0x40,0x3F,0x37,0x38,0x36,
		0x3C,0x3B,0x35,0x37,0x3A,0x37,0x37,0x38,0x35,0x32,0x31,0x30,0x24,0x21,0x1A,0x1D,
		0x25,0x24,0x25,0x32,0x30,0x38,0x3C,0x41,0x3B,0x3E,0x49,0x52,0x4A,0x4D,0x4C,0x5B,
		0x5B,0x59,0x5E,0x66,0x5C,0x56,0x4F,0x46,0x48,0x3E,0x3D,0x43,0x43,0xFB,0x39,0x3A,
		0x36,0x38,0x35,0x3E,0x4A,0x47,0x3E,0x3C,0x3A,0x43,0x48,0x44,0x45,0x3D,0x3F,0x3A,
		0x3D,0x34,0x36,0x34,0x35,0x33,0x3C,0x3C,0x39,0x31,0x2A,0x2B,0x25,0x1D,0x19,0x15,
		0x1B,0x1A,0x24,0x2A,0x33,0x3A,0x41,0x47,0x48,0x41,0x45,0x4D,0x5C,0x59,0x56,0x5D,
		0x67,0x6D,0x6C,0x6F,0x6C,0x61,0x5A,0x57,0x51,0x4A,0x48,0x46,0x4A,0x41,0x43,0x43,
		0x49,0x43,0x40,0x48,0x56,0x51,0x4A,0x41,0x3F,0x45,0x47,0x51,0x50,0x4D,0x48,0x3F,
		0x45,0x3D,0x36,0x34,0x32,0x31,0x35,0x32,0x2E,0x32,0x31,0x2C,0x28,0x1D,0x23,0x1B,
		0x15,0x19,0x27,0x2A,0x32,0x33,0x41,0x48,0x4F,0x52,0x55,0x56,0x66,0x66,0xFA,0x66,
		0x6A,0x6F,0x6E,0x6D,0x71,0x68,0x67,0x64,0x64,0x5A,0x53,0x4B,0x4E,0x4F,0x48,0x4C,
		0x51,0x58,0x53,0x4B,0x54,0x5A,0x56,0x53,0x4D,0x4B,0x4A,0x4B,0x58,0x5E,0x51,0x4A,
		0x46,0x45,0x41,0x40,0x37,0x35,0x31,0x2F,0x28,0x2C,0x29,0x30,0x2E,0x26,0x27,0x25,
		0x1B,0x17,0x21,0x24,0x2C,0x2D,0x35,0x3E,0x50,0x5C,0x5C,0x5E,0x65,0x68,0x6C,0x7A,
		0x79,0x7B,0x7A,0x77,0x75,0x6E,0x71,0x6F,0x6C,0x6D,0x5F,0x58,0x50,0x4E,0x4E,0x56,
		0x5A,0x62,0x63,0x5E,0x5F,0x50,0x4D,0x4B,0x49,0x4E,0x49,0x4D,0x54,0x50,0x4C,0x4A,
		0x4A,0x48,0x4B,0x4B,0x44,0x40,0x3B,0x33,0x39,0x36,0x2B,0x60,0x68,0xEC,0x23,0x29,
		0x24,0x20,0x22,0x28,0x2A,0x30,0x39,0x40,0x45,0x4C,0x52,0x53,0x5C,0x5E,0x64,0x6D,
		0x6A,0x71,0x66,0x65,0x65,0x61,0x5A,0x5F,0x69,0x64,0x60,0x5D,0x4F,0x4F,0x4E,0x4E,
		0x5B,0x62,0x61,0x5D,0x57,0x49,0x46,0x48,0x4D,0x55,0x4D,0x4E,0x4F,0x4C,0x48,0x49,
		0x4C,0x51,0x03,0xC3,0x54,0x51,0x4D,0xE6,0x40,0x43,0x33,0x24,0x21,0x24,0x24,0x29,
		0x29,0x31,0x30,0x2F,0x32,0x34,0x3D,0x40,0x46,0x47,0x46,0x49,0x51,0x5B,0x5E,0x65,
		0x62,0x62,0x5E,0x52,0x02,0x4B,0x4C,0x4E,0xE0,0x65,0x64,0x5C,0x56,0x21,0x8B,0x4D,
		0xE7,0x5B,0x57,0x5C,0x4D,0x48,0x47,0x49,0x4D,0x56,0x4F,0x48,0x48,0x49,0x4B,0x49,
		0x55,0x57,0x54,0x52,0x4D,0x48,0x44,0x43,0x40,0x49,0x33,0x2B,0x29,0x25,0x27,0x2B,
		0x31,0x42,0x48,0x34,0x2E,0xE5,0x38,0x41,0x3B,0x43,0x45,0x4A,0x4C,0x53,0x51,0x54,
		0x54,0x57,0x51,0x44,0x44,0x45,0x47,0x4B,0x51,0x62,0x54,0x4E,0x49,0x44,0x02,0x4A,
		0x45,0x4E,0xE9,0x57,0x50,0x4A,0x4B,0x44,0x47,0x50,0x49,0x4A,0x43,0x46,0x50,0x52,
		0x56,0x59,0x5C,0x58,0x55,0x54,0x4D,0x4B,0x45,0x49,0x3F,0x33,0x29,0x20,0x2B,0x36,
		0x37,0x3C,0x35,0x33,0x36,0x3C,0x39,0x3B,0x3E,0x3A,0x41,0x20,0xBC,0xE0,0x4B,0x4C,
		0x45,0x48,0x23,0x6C,0x42,0x3C,0x39,0xF0,0x4D,0x59,0x54,0x47,0x41,0x43,0x46,0x44,
		0x49,0x50,0x51,0x4C,0x4F,0x3F,0x39,0x3B,0x3F,0x3F,0x47,0x4A,0x4C,0x49,0x4C,0x50,
		0x53,0x56,0x54,0x56,0x54,0x5B,0x50,0x46,0x48,0x4F,0x45,0x39,0x2C,0x25,0x2C,0x38,
		0x36,0x36,0x3B,0x3D,0x3C,0x3E,0x3E,0x3C,0x44,0x3E,0x3F,0x41,0x48,0x4D,0x4F,0x4A,
		0x47,0x4A,0x44,0x3F,0x41,0x3F,0x46,0x46,0x51,0x5B,0x4C,0x4B,0x23,0xD7,0x41,0x45,
		0x42,0xEC,0x43,0x3A,0x3B,0x38,0x36,0x34,0x36,0x31,0x3D,0x49,0x49,0x4E,0x48,0x48,
		0x53,0x58,0x5B,0x58,0x60,0x62,0x51,0x4B,0x4F,0x50,0x45,0x41,0x37,0x2D,0x34,0x39,
		0x31,0x2D,0x33,0x41,0x41,0x3E,0x41,0x47,0x46,0x48,0x41,0x41,0x4C,0x50,0x4F,0x52,
		0x4D,0x4D,0x47,0x3D,0x3F,0x3B,0x23,0x2F,0x41,0x4A,0x52,0xE7,0x4A,0x3F,0x45,0x48,
		0x3F,0x3F,0x3A,0x2F,0x35,0x29,0x2A,0x2A,0x2A,0x26,0x32,0x38,0x48,0x50,0x48,0x46,
		0x4C,0x51,0x5A,0x58,0x62,0x5F,0x5B,0x52,0x4F,0x56,0x4E,0x41,0x03,0x01,0x37,0x2F,
		0x33,0xE6,0x3A,0x3E,0x3F,0x3D,0x49,0x4E,0x51,0x4A,0x4D,0x50,0x4F,0x53,0x50,0x4E,
		0x4B,0x42,0x40,0x39,0x34,0x32,0x3E,0x3C,0x43,0x52,0x4B,0x4D,0x43,0x45,0x60,0x0E,
		0xFA,0x39,0x33,0x2F,0x29,0x17,0x18,0x21,0x1F,0x20,0x2A,0x2F,0x41,0x4E,0x50,0x4A,
		0x4E,0x55,0x5F,0x63,0x61,0x5F,0x61,0x5B,0x56,0x59,0x4B,0x47,0x3E,0x34,0x2E,0x2A,
		0x29,0x32,0x35,0x3A,0x3C,0x3E,0x47,0x53,0x51,0x56,0x52,0x59,0x58,0x52,0x46,0x44,
		0x47,0x42,0x3B,0x31,0x35,0x31,0x30,0x39,0x45,0x4B,0x4D,0x4C,0x4D,0x48,0x43,0x3F,
		0x3B,0x33,0x31,0x2D,0x24,0x18,0x1C,0x1F,0x1F,0x21,0x28,0x2F,0x3E,0x50,0x4D,0x49,
		0x52,0x4F,0x52,0x5E,0x5A,0x57,0x55,0x55,0x4C,0x52,0x4B,0x43,0x3D,0x30,0x30,0x26,
		0x2E,0x36,0x33,0x30,0x38,0x37,0x43,0x54,0x54,0x5D,0x58,0x5F,0x58,0x41,0x1A,0x52,
		0xE9,0x31,0x37,0x35,0x2D,0x30,0x2D,0x35,0x3B,0x45,0x3C,0x37,0x3E,0x40,0x40,0x38,
		0x29,0x27,0x1F,0x20,0x22,0x21,0x1C,0x1A,0x20,0x2A,0x2D,0x2C,0x37,0x4A,0x4E,0x51,
		0x49,0x49,0x54,0x59,0x57,0x55,0x4D,0x47,0x43,0x01,0x99,0x47,0xED,0x32,0x30,0x28,
		0x2E,0x38,0x35,0x30,0x38,0x39,0x42,0x4E,0x57,0x5E,0x5C,0x5E,0x57,0x59,0x50,0x48,
		0x35,0x2A,0x2D,0x31,0x27,0x28,0x2F,0x34,0x39,0x37,0x31,0x2C,0x38,0x3C,0x35,0x30,
		0x26,0x15,0x11,0x16,0x1E,0x1E,0x20,0x1C,0x21,0x27,0x2E,0x30,0x41,0x47,0x51,0x4B,
		0x4A,0x4E,0x4F,0x4B,0x4E,0x41,0xC4,0x48,0xE1,0x45,0x36,0x34,0x31,0x30,0x31,0x2F,
		0x2E,0x23,0xB0,0x39,0x33,0x3A,0xE0,0x49,0x53,0x5C,0x56,0x00,0x58,0xEB,0x50,0x3C,
		0x2F,0x25,0x28,0x29,0x26,0x20,0x28,0x27,0x2B,0x33,0x2D,0x26,0x2A,0x2F,0x27,0x1A,
		0x15,0x0C,0x11,0x17,0x1A,0x1B,0x1D,0x1B,0x19,0x22,0x2A,0x37,0x3D,0x4B,0x4D,0x4E,
		0x52,0x52,0x45,0x3D,0x3D,0x3D,0x37,0x33,0x33,0x3B,0x30,0x28,0x27,0x2A,0x42,0x7B,
		0x2C,0x34,0xED,0x41,0x3E,0x42,0x4B,0x4C,0x53,0x5F,0x55,0x52,0x52,0x5A,0x46,0x37,
		0x2B,0x24,0x1A,0x1A,0x15,0x16,0x18,0x24,0x27,0x29,0x22,0x26,0x1F,0x1F,0x11,0x0D,
		0x0A,0x0B,0x0A,0x10,0x18,0x15,0x14,0x19,0x18,0x1D,0x2D,0x39,0x3F,0x42,0x44,0x44,
		0x4C,0x50,0x42,0x45,0x40,0x3C,0x37,0x35,0x33,0x39,0x2A,0x03,0xBD,0x2C,0x2D,0x29,
		0xEA,0x34,0x39,0x44,0x45,0x44,0x4E,0x58,0x5D,0x5D,0x56,0x57,0x53,0x59,0x43,0x34,
		0x22,0x1E,0x19,0x17,0x12,0x06,0x12,0x1C,0x1D,0x20,0x21,0x28,0x1C,0x1A,0x14,0x10,
		0x11,0x0F,0x07,0x0A,0x0A,0x0E,0x0B,0x13,0x17,0x1B,0x29,0x38,0x3B,0x01,0x42,0x37,
		0xEE,0x47,0x47,0x47,0x3F,0x35,0x37,0x34,0x33,0x2F,0x2B,0x2B,0x28,0x28,0x35,0x3B,
		0x37,0x3B,0x3D,0x47,0x47,0x44,0x4F,0x5C,0x5D,0x60,0x60,0x58,0x55,0x58,0x45,0x2C,
		0x24,0x14,0x19,0x19,0x0F,0x01,0x0D,0x1A,0x18,0x20,0x1D,0x25,0x1C,0x19,0x19,0x16,
		0x17,0x11,0x06,0x05,0x0C,0x06,0x10,0x10,0x16,0x22,0x22,0x31,0x36,0x08,0x2C,0xFB,
		0x47,0x45,0x38,0x38,0x35,0x36,0x32,0x27,0x2C,0x2E,0x2B,0x30,0x35,0x3B,0x42,0x4C,
		0x49,0x51,0x4D,0x4D,0x51,0x56,0x58,0x58,0x55,0x55,0x55,0x50,0x3E,0x29,0x1B,0x13,
		0x16,0x19,0x0B,0x01,0x09,0x14,0x1B,0x18,0x20,0x21,0x1C,0x14,0x11,0x10,0x12,0x0F,
		0x06,0x05,0x0A,0x07,0x0E,0x13,0x16,0x21,0x26,0x27,0x2D,0x36,0x37,0x3F,0x43,0x4A,
		0x44,0x3B,0x3C,0x3C,0x31,0x31,0x28,0x27,0x2D,0x2F,0x37,0x3A,0x3B,0x40,0x4E,0x56,
		0x58,0x60,0x57,0x59,0x5D,0x5A,0x58,0x54,0x59,0x56,0x4E,0x47,0x38,0x2D,0x1C,0x16,
		0x0E,0x11,0x06,0xFD,0x08,0x14,0x12,0x19,0x1D,0x1B,0x1B,0x18,0x0D,0x07,0x03,0x0A,
		0xFB,0x09,0x06,0x04,0x07,0x08,0x0E,0x1B,0x1D,0x24,0x28,0x2B,0x35,0x36,0x37,0x44,
		0x4C,0x47,0x3A,0x41,0x40,0x3F,0x2F,0x2F,0x24,0x2F,0x2D,0x33,0x3C,0x3B,0x43,0x4F,
		0x56,0x56,0x5D,0x5A,0x57,0x56,0x59,0x52,0x51,0x48,0x46,0x48,0x48,0x37,0x25,0x1C,
		0x0E,0x0E,0x0F,0x02,0xFF,0x06,0x0D,0x0B,0x0E,0x10,0x0F,0x17,0x12,0x0A,0x08,0x04,
		0x05,0x09,0x05,0x02,0x09,0x0C,0x10,0x1C,0x21,0x28,0x2A,0x30,0x2F,0x34,0x3A,0x3B,
		0x47,0x43,0x44,0x48,0x4B,0x40,0x34,0x2F,0x29,0x30,0x36,0x3B,0x3C,0x46,0x4D,0x4D,
		0x4E,0x53,0x5A,0x5E,0x5A,0x59,0x51,0x4E,0x4E,0x42,0x3F,0x43,0x43,0x30,0x22,0x12,
		0x0C,0xFB,0x0C,0x0C,0x01,0xF8,0xFF,0x02,0x0C,0x0E,0x0B,0x0D,0x0C,0x10,0x0F,0x0E,
		0x0D,0x07,0x0B,0x07,0x0C,0x07,0x0D,0x0D,0x1E,0x21,0x24,0x2B,0x2F,0x2B,0x31,0x35,
		0x3C,0x46,0x4A,0x47,0x4B,0x4F,0x41,0x3B,0x36,0x2E,0x3A,0x3F,0x38,0x41,0x43,0x44,
		0x51,0x50,0x54,0x60,0x58,0x5B,0x51,0x55,0x48,0x40,0x42,0x3C,0x35,0x3C,0x25,0x21,
		0x12,0x10,0x12,0x10,0x06,0xFB,0x01,0x05,0x0A,0x0D,0x0B,0x0A,0x0D,0x0E,0x10,0x11,
		0x0E,0x06,0x03,0x09,0x08,0x05,0x08,0x0F,0x1E,0x29,0x2F,0x2F,0x2A,0x2C,0x35,0x39,
		0x3C,0x47,0x45,0x4D,0x48,0x4B,0x43,0x43,0x41,0x3C,0x3B,0x41,0x40,0x42,0x3F,0x46,
		0x50,0x5B,0xE9,0x58,0x5E,0x61,0x5F,0x5C,0x51,0x42,0x3D,0x37,0x3B,0x34,0x2E,0x22,
		0x18,0x18,0x17,0x17,0x15,0x0C,0x08,0x08,0x04,0x09,0x11,0x11,0x0C,0x10,0x13,0x17,
		0x13,0x09,0x09,0x09,0x05,0x01,0x07,0x08,0x11,0x1E,0x27,0x01,0x40,0x2C,0xFB,0x30,
		0x3D,0x40,0x41,0x45,0x4B,0x4F,0x4F,0x4C,0x44,0x41,0x37,0x39,0x3A,0x3D,0x38,0x41,
		0x48,0x4B,0x50,0x53,0x5B,0x5D,0x59,0x59,0x4F,0x42,0x3A,0x3B,0x39,0x2F,0x29,0x20,
		0x17,0x19,0x16,0x19,0x16,0x0E,0x05,0x05,0x03,0x02,0x04,0x06,0x0D,0x0C,0x0C,0x03,
		0x07,0x00,0x01,0x03,0x02,0x05,0x09,0x0D,0x0B,0x1C,0x29,0x2D,0x2F,0x32,0x31,0x34,
		0x39,0x3C,0x3F,0x47,0x49,0x4F,0x5A,0x58,0x50,0x46,0x3A,0x33,0x37,0x37,0x37,0x3F,
		0x44,0x4B,0x50,0x56,0x56,0x54,0x5B,0x51,0x50,0x46,0x3E,0x3D,0x41,0x37,0x29,0x1D,
		0x1C,0x19,0x18,0x1A,0x16,0x09,0x04,0x01,0xFE,0x01,0x01,0x05,0x07,0x05,0x04,0xE6,
		0xFE,0xF8,0xFC,0x02,0x00,0xFE,0x00,0x0E,0x0D,0x0A,0x13,0x20,0x22,0x2C,0x2E,0x37,
		0x3B,0x3B,0x41,0x3A,0x41,0x4C,0x50,0x5F,0x5B,0x51,0x47,0x3C,0x41,0xC4,0x3A,0xE2,
		0x3A,0x3F,0x4A,0x58,0x55,0x54,0x5F,0x5E,0x59,0x52,0x4D,0x44,0x41,0xFB,0x44,0xF0,
		0x25,0x21,0x1C,0x1E,0x1A,0x1A,0x0B,0x06,0x07,0x00,0xFF,0xF3,0xFC,0xF9,0xFC,0xFA,
		0xFA,0xF6,0xF8,0xFE,0xFF,0xFB,0x03,0x0F,0x0C,0x14,0x15,0x17,0x1D,0x26,0x32,0x42,
		0x46,0x42,0x3E,0x3D,0x3F,0x49,0x51,0x61,0x5A,0x54,0x45,0x3F,0x3D,0x3C,0x3B,0x34,
		0x34,0x3D,0x4E,0x59,0x59,0x57,0x5F,0x6A,0x5B,0x56,0x55,0x4F,0x44,0x3D,0x32,0x28,
		0x2D,0x2E,0x29,0x22,0x40,0xBF,0xEF,0x0D,0x0B,0x04,0xFA,0xEF,0xEE,0xF3,0xF0,0xEB,
		0xEE,0xF5,0xF9,0xFB,0xFF,0xFD,0x07,0x12,0x0C,0x13,0x13,0x11,0x1A,0x1B,0x29,0x39,
		0x37,0x3F,0x42,0x3F,0x41,0x48,0x52,0x5D,0x5A,0x59,0x4D,0x46,0x48,0x3F,0x3B,0x38,
		0x41,0x4A,0x4A,0x57,0x5B,0x56,0x5A,0x65,0x5A,0x4C,0x47,0x44,0x41,0x3A,0x33,0x30,
		0x2F,0x2F,0x21,0x18,0x16,0x1B,0x13,0x40,0xF3,0xE6,0x03,0xF8,0xF6,0xEE,0xF1,0xEF,
		0xF0,0xF3,0xF0,0xFE,0x02,0x01,0x04,0x0E,0x0A,0x0E,0x0E,0x11,0x14,0x18,0x22,0x35,
		0x32,0x39,0x3B,0x44,0x45,0x4E,0x03,0xF4,0x53,0x63,0x5A,0xF4,0x51,0x4B,0x47,0x41,
		0x43,0x4F,0x54,0x5A,0x5A,0x58,0x5C,0x60,0x4E,0x46,0x3E,0x3F,0x34,0x32,0x37,0x3A,
		0x36,0x2A,0x25,0x18,0x1A,0x1C,0x13,0x10,0x0D,0x0A,0x07,0xFD,0xFC,0xF2,0xF0,0xF2,
		0xF0,0xEA,0xF3,0xF8,0xFB,0x06,0x06,0x08,0x0D,0x0F,0x10,0x0F,0x15,0x11,0x20,0x26,
		0x34,0x39,0x42,0x49,0x51,0x52,0x53,0x60,0x5A,0x5E,0x5B,0x5A,0x51,0x4E,0x47,0x44,
		0x4A,0x4A,0x51,0x56,0x55,0x4D,0x4D,0x56,0x4A,0x3E,0x3B,0x3B,0x32,0x31,0x38,0x3D,
		0x62,0x74,0x39,0x33,0xE1,0x17,0x17,0x14,0x0B,0x05,0x05,0xFD,0xF6,0x01,0xC1,0xF4,
		0xE5,0xF2,0xF6,0xF3,0x01,0x02,0x07,0x08,0x06,0x0C,0x0A,0x10,0x10,0x12,0x1A,0x1F,
		0x26,0x33,0x45,0x52,0x56,0x5B,0x5B,0x56,0x58,0x42,0xF1,0x61,0x5E,0xFB,0x4F,0x49,
		0x4F,0x4D,0x4F,0x58,0x4D,0x47,0x45,0x45,0x42,0x38,0x35,0x31,0x33,0x37,0x38,0x41,
		0x3E,0x37,0x29,0x1B,0x1B,0x14,0x14,0x10,0x05,0x04,0xFF,0xFF,0xF4,0xEF,0xEF,0xF2,
		0xF3,0xF7,0xF9,0xF2,0xFE,0x02,0x04,0x00,0x01,0x08,0x09,0x07,0x06,0x06,0x15,0x1A,
		0x1E,0x2A,0x37,0x47,0x52,0x53,0x59,0x5C,0x61,0x5E,0x5C,0x5D,0x55,0x58,0x4E,0x4C,
		0x4C,0x4D,0x4B,0x58,0x4E,0x44,0x40,0x3F,0x39,0x35,0x32,0x2A,0x32,0x34,0x3A,0x41,
		0x3B,0x31,0x2A,0x20,0x17,0x11,0x13,0x0E,0x09,0x09,0x06,0x01,0xFD,0xF7,0xF7,0xF0,
		0xFC,0xFD,0xFD,0xF6,0xFA,0x00,0xFE,0xF6,0xF6,0xFD,0x00,0xFD,0x02,0x04,0xFB,0x0E,
		0x12,0x1D,0x25,0x36,0x44,0x4F,0x56,0x59,0x61,0x5D,0x64,0x61,0x5E,0x5E,0x5F,0x56,
		0x47,0x45,0x4E,0x4E,0x50,0x4E,0x4A,0x43,0x39,0x3C,0x3C,0x37,0x2B,0x2F,0x37,0x42,
		0x4A,0x3C,0x2D,0x27,0x2B,0x23,0x17,0x18,0x16,0x0F,0x0F,0x03,0x02,0xFE,0xF9,0xF4,
		0xF3,0xF8,0x04,0xF9,0xF8,0xFC,0x03,0xFC,0xF5,0xF7,0xFA,0xF9,0xF0,0xF7,0xF9,0x09,
		0x13,0x18,0x2D,0x32,0x40,0x49,0x56,0x5F,0x63,0x6A,0x66,0x5F,0x5E,0x60,0x5F,0x59,
		0x4C,0x50,0x4E,0x55,0x4E,0x47,0x46,0x3B,0x37,0x3A,0x31,0x2F,0x34,0x31,0x36,0x3E,
		0x44,0x3D,0x2F,0x2F,0x31,0x22,0x25,0x1B,0x1F,0x19,0x15,0x0F,0x0C,0x07,0x04,0xEA,
		0x04,0xFE,0x00,0x02,0xFC,0x00,0xF8,0xFA,0xFA,0xEF,0xF1,0xF6,0xF5,0xEB,0xF1,0xF3,
		0x00,0x0C,0x21,0x2E,0x34,0x3E,0x49,0x57,0x60,0x6F,0x6B,0x68,0x67,0x62,0x5B,0x59,
		0x53,0x58,0x57,0x52,0x52,0x56,0x44,0x3D,0x3A,0x37,0x36,0x2D,0x23,0xDC,0x2F,0x37,
		0x36,0xEE,0x39,0x3B,0x31,0x2F,0x31,0x2E,0x24,0x20,0x25,0x22,0x1C,0x1A,0x13,0x11,
		0x05,0x01,0xFF,0xFB,0x04,0x06,0xFE,0xF3,0xF4,0xF9,0xFA,0xFC,0xF4,0xF1,0xF5,0xFC,
		0x03,0x0D,0x17,0x29,0x36,0x3E,0x45,0x50,0x62,0x71,0x63,0x62,0x5E,0x58,0x5A,0x55,
		0x51,0x4F,0x4E,0x4D,0x46,0x4A,0x42,0x39,0x34,0x2F,0x33,0x30,0x34,0x37,0x21,0xBE,
		0x35,0xEF,0x34,0x30,0x30,0x2B,0x2C,0x30,0x2B,0x20,0x1C,0x23,0x1E,0x1B,0x19,0x12,
		0x08,0xFC,0xFC,0xF4,0xFC,0x00,0xF6,0xEF,0xF2,0xFA,0xFE,0xFF,0xFA,0xF2,0xF6,0xFC,
		0x01,0x0D,0x1A,0x26,0x34,0x3D,0x47,0x52,0x63,0x6F,0x66,0x55,0x51,0x56,0x54,0x4D,
		0x45,0x3E,0x40,0x40,0x45,0x43,0x3B,0x35,0x32,0x2B,0x2B,0x33,0x2F,0x30,0x32,0x3B,
		0x35,0x2E,0x01,0x3E,0x2E,0xEC,0x27,0x2A,0x2B,0x26,0x25,0x1D,0x19,0x17,0x15,0x14,
		0x04,0xF3,0xF3,0xF1,0xF5,0xF7,0xF4,0xEE,0xF7,0xF8,0x00,0x03,0x00,0x02,0xFD,0x09,
		0x0F,0x0C,0x1F,0x27,0x33,0x3E,0x47,0x59,0x60,0x6D,0x64,0x53,0x56,0x4A,0x48,0x45,
		0x42,0x35,0x3B,0x39,0x41,0x47,0x41,0x38,0x2F,0x25,0x01,0x40,0x28,0xF0,0x33,0x37,
		0x29,0x25,0x25,0x25,0x22,0x27,0x29,0x2B,0x30,0x34,0x26,0x22,0x1B,0x16,0x18,0x12,
		0xFF,0xF7,0xF0,0xE6,0xEA,0xEA,0xEF,0xF1,0xFA,0xFF,0x03,0x07,0x07,0x0D,0x10,0x0F,
		0x0E,0x14,0x24,0x2F,0x3F,0x4A,0x4D,0x5A,0x59,0x63,0x5C,0x5C,0x53,0x49,0x45,0x3D,
		0x35,0x36,0x34,0x37,0x3D,0x45,0x42,0x3B,0x2D,0x26,0x2B,0x2B,0x2F,0x34,0x2F,0x2D,
		0x25,0x22,0x80,0x0B,0xD2,0xF6,0x1F,0x25,0x2D,0x3B,0x38,0x30,0x26,0x1E,0x0E,0x08,
		0xFE,0xF3,0xE6,0xE3,0xE6,0xE0,0xEB,0xF4,0xFB,0x02,0x05,0x08,0x0C,0x0E,0x14,0x14,
		0x18,0x19,0x24,0x32,0x39,0x45,0x4A,0x5A,0x59,0x59,0x52,0x48,0x47,0x3E,0x3A,0x37,
		0x35,0x38,0x36,0x37,0x3D,0x40,0x3B,0x36,0x31,0x1D,0x22,0x29,0x28,0x22,0x28,0x25,
		0x1F,0x20,0x22,0x1E,0x1A,0x14,0x1F,0x26,0x2F,0x37,0x33,0x26,0x25,0x14,0x0C,0x05,
		0xF6,0xE4,0xE5,0xE0,0xE0,0xDD,0xEA,0xF3,0xF7,0x03,0xFD,0x02,0x05,0x0C,0x12,0x1B,
		0x1C,0x24,0x22,0xFF,0x2F,0x32,0xE1,0x52,0x50,0x4E,0x40,0x3D,0x33,0x33,0x2D,0x62,
		0xC0,0x32,0x31,0xE1,0x3E,0x3F,0x3C,0x3A,0x29,0x1E,0x1F,0x21,0x00,0xF0,0xFB,0x1E,
		0x1A,0x1E,0x1B,0x1B,0x16,0x19,0x28,0x2F,0x34,0x35,0x2A,0x26,0x1A,0x13,0x06,0xFE,
		0xF1,0xDD,0xDF,0xE4,0xDF,0xE2,0xE9,0xF3,0xFE,0x01,0x06,0x09,0x10,0x12,0x19,0x1E,
		0x27,0x2B,0x2D,0x3B,0x3E,0x3E,0x45,0x4E,0x42,0x40,0x3E,0x3F,0x3A,0x34,0x32,0x2F,
		0x35,0x3A,0x38,0x35,0x36,0x3E,0x38,0x38,0x27,0x20,0x24,0x22,0x1B,0x11,0x19,0x1B,
		0x17,0x19,0x1D,0x18,0x1D,0x20,0x22,0x31,0x34,0x36,0x2D,0x1F,0x19,0x08,0x03,0xF9,
		0xE6,0xDE,0xDA,0xDD,0xDD,0xE2,0xE9,0xEF,0xF5,0xFB,0x00,0x0D,0x19,0x1E,0x1F,0x26,
		0x2A,0x34,0x3C,0x40,0x41,0x41,0x3F,0x43,0x3A,0x39,0x39,0x3B,0x36,0x2E,0x27,0x42,
		0xB6,0x29,0x32,0xE1,0x37,0x3B,0x36,0x35,0x2B,0x26,0x24,0x1C,0x02,0x40,0x12,0x0F,
		0xEE,0x1C,0x20,0x1E,0x1D,0x26,0x24,0x2C,0x30,0x35,0x2C,0x1C,0x0E,0x08,0xFD,0xF2,
		0xEA,0xD9,0xDC,0xDB,0xDB,0xDE,0xE6,0xEB,0xF1,0xF5,0xFB,0x03,0x0B,0x15,0x1C,0x23,
		0x2E,0x35,0x32,0x3B,0x3B,0x38,0x3B,0x42,0x3C,0x39,0x35,0x2C,0x2A,0x29,0x2A,0x2A,
		0x2B,0x33,0x32,0x32,0x28,0x2D,0x2B,0x2A,0x21,0x23,0x1C,0x15,0x12,0x62,0xE2,0x07,
		0x11,0xE2,0x16,0x13,0x1D,0x1F,0x1C,0x27,0x2A,0x2F,0x22,0x1B,0x0E,0x00,0x03,0x3E,
		0xFC,0xF2,0xEC,0xE1,0xE0,0xE8,0xEF,0xF3,0xF2,0xF8,0xF7,0xFE,0x23,0xBC,0x04,0x07,
		0x16,0xFB,0x34,0x36,0x32,0x30,0x37,0x3A,0x3A,0x35,0x31,0x28,0x24,0x22,0x2E,0x35,
		0x2D,0x2C,0x26,0x2A,0x26,0x1B,0x22,0x23,0x19,0x19,0x17,0x0D,0x08,0x08,0x08,0x0A,
		0x11,0x15,0x17,0x13,0x13,0x10,0x17,0x1E,0x20,0x27,0x1F,0x18,0x0A,0xFC,0xF9,0xF6,
		0xEA,0xE2,0xE2,0xE3,0xE4,0xED,0xF2,0xF5,0xFB,0xFA,0xF2,0xF4,0xFF,0xFE,0x07,0x1A,
		0x1E,0x29,0x2C,0x26,0x25,0x24,0x29,0x2E,0x35,0x37,0x30,0x24,0x24,0x20,0x29,0x2F,
		0x2D,0x2A,0x26,0x1E,0x15,0x0B,0x10,0x10,0x15,0x15,0x14,0x11,0x09,0x0A,0x0E,0x08,
		0x0A,0x13,0x0D,0x0C,0x05,0x08,0x0E,0x15,0x18,0x22,0x1D,0x11,0x09,0xFA,0xF3,0xF3,
		0xE2,0xDF,0xFB,0xE4,0xEA,0xEA,0xF7,0xF3,0xF8,0xFC,0xF4,0xF0,0xF0,0xF2,0xF8,0x02,
		0x12,0x1B,0x20,0x1B,0x1F,0x24,0x21,0x28,0x2C,0x2B,0x32,0x2D,0x21,0x1D,0x22,0x23,
		0x27,0x25,0x28,0x25,0x1B,0x12,0x02,0x05,0x05,0x05,0x0B,0x08,0x0F,0x0F,0x0F,0x0D,
		0x0D,0x0F,0x0D,0x08,0x04,0x05,0x04,0x0B,0x0B,0x16,0x1C,0x18,0x12,0x0D,0x00,0xF6,
		0xEB,0xDD,0xD9,0xE6,0xF0,0xF4,0xF8,0xF6,0xFE,0xFC,0xF1,0xF3,0xF8,0xF8,0xEE,0xFC,
		0x0A,0x0E,0x14,0x12,0x14,0x1F,0x21,0x1F,0x21,0x29,0x2B,0x22,0x1E,0x1D,0x20,0x19,
		0x19,0x1A,0x1E,0x14,0x13,0x07,0x04,0x01,0x04,0x05,0x01,0x03,0x09,0x07,0x13,0x0E,
		0x0D,0x0E,0x0E,0xE0,0x10,0x0B,0x0C,0x0C,0x41,0x2A,0x0D,0xE5,0x10,0x0E,0x09,0xFE,
		0xF1,0xEF,0xDF,0xE0,0xE9,0xF2,0xF0,0xF9,0xFA,0x00,0xFB,0xF1,0xF1,0xF9,0xEE,0xEC,
		0xF8,0xFD,0x00,0x02,0x03,0x36,0x07,0x14,0x11,0xE4,0x20,0x1F,0x1B,0x19,0x1A,0x19,
		0x17,0x11,0x14,0x0F,0x07,0x07,0x04,0x05,0xFF,0x02,0x05,0x02,0xFE,0xFE,0x43,0xA0,
		0x05,0x14,0x0F,0xE4,0x12,0x13,0x14,0x16,0x12,0x08,0x01,0x04,0x04,0x02,0x04,0x02,
		0xF2,0xEB,0xE6,0xDE,0xE7,0xEB,0xF6,0x01,0x80,0x44,0x07,0xFF,0xEE,0xF6,0xF2,0xF1,
		0xF3,0xF6,0xFE,0xF8,0x01,0x06,0x0A,0x19,0x16,0x14,0x0F,0x12,0x11,0x12,0x0E,0x0C,
		0x0C,0x0A,0x0B,0x03,0x04,0xFE,0x03,0xFE,0xFE,0xFE,0xFF,0x00,0xFD,0x00,0x08,0x0D,
		0x0C,0x0F,0x11,0x0D,0x10,0x15,0x1B,0x14,0x0E,0x08,0x05,0x00,0xFF,0xF7,0xFD,0xFD,
		0xF9,0xF7,0xEC,0xE6,0xEE,0xF1,0xFE,0x03,0x01,0xCE,0x10,0x0F,0xFF,0xFE,0xF8,0xCC,
		0x10,0x0F,0xFF,0xCC,0x10,0x0F,0xFF,0xCC,0x10,0x0F,0xFF,0x8C,0x20,0x30,0x8A,0x40,
		0x10,0xFF,0xE1,0x50,0x81,0x0F,0x09,0x80,0x07,0x0B,0x00,0x20,0x04,0x00,0x00,0x05,
		0x00,0x07,0xE0,0x0A,0x80,0x0F,0x06,0x09,0x09,0x00,0xE0,0x07,0x18,0x80,0x0F,0x05,
		0x0A,0x04,0xE0,0x03,0x09,0x80,0xFF,0x07,0x12,0x0C,0x00,0x06,0x06,0x00,0x03,0xFF,
		0xE0,0x06,0x08,0x80,0x07,0x0E,0x0B,0x08,0x00,0xE1,0xFF,0x0E,0x16,0x80,0x0F,0x01,
		0x00,0x03,0x80,0x63,0x75,0x28,0x0A,0x0B,0x06,0x15,0x09,0x0B,0x2A,0x09,0x0B,0x13,
		0x09,0x0B,0x2C,0x09,0x0B,0x11,0x09,0x0B,0x2E,0x09,0x0B,0x0F,0x09,0x0B,0x30,0x05,
		0x0B,0x0D,0x06,0x0B,0x0B,0x32,0x98,0x80,0x0B,0x0E,0x0C,0x09,0x0B,0x03,0x0A,0x17,
		0x06,0x0B,0x09,0x17,0x34,0x00,0xA9,0xC0,0x00,0x0B,0x58,0x08,0x6B,0x09,0x77,0x09,
		0x99,0x40,0x9B,0x0C,0xC0,0x00,0xB3,0x56,0xBD,0x00,0x83,0xC0,0x00,0xB3,0x7A,0x28,
		0xDF,0x29,0xEB,0x09,0x29,0xF7,0x0C,0x49,0x03,0x09,0x49,0x0F,0x0C,0x49,0x1B,0x09,
		0x49,0x27,0x0C,0x49,0x33,0x09,0x49,0x3F,0x0C,0x49,0x4B,0x09,0x46,0x7E,0x0C,0x17,
		0xE0,0x0D,0x0D,0x0D,0x09,0x48,0x7E,0x01,0x09,0x0C,0x4A,0x71,0x0D,0x09,0xE0,0x0C,
		0x08,0x80,0x0D,0x0E,0x0B,0x08,0x00,0xE0,0xFF,0x0E,0x1B,0x80,0x40,0xC3,0x55,0xC3,
		0x0D,0x04,0x25,0x49,0xC3,0x0D,0x08,0x09,0xE0,0x0D,0x4C,0x81,0x0F,0xFC,0x49,0x4C,
		0x45,0x53,0x00,0x00,0x00,0x00,0x12,0x00,0x00,0x00,0xF9,0xBE,0xE6,0x81,0x06,0x00,
		0x03,0x00,0x27,0x00,0x00,0x00,0x04,0x00,0x60,0xC9,0x14,0xFD,0x49,0x4C,0x45,0x53,
		0x01,0x00,0x00,0x00,0x12,0x00,0x00,0x00,0x74,0x19,0x12,0xEF,0x0B,0x00,0x08,0x00,
		0x03,0x00,0x01,0x00,0x04,0x00,0x2C,0x5C,0x55,0x5D,0x49,0x4C,0x45,0x53,0x02,0x00,
		0x00,0x00,0x12,0x00,0x00,0x00,0x42,0x48,0x9C,0x72,0x0D,0x00,0x02,0x00,0x03,0x00,
		0x01,0x00,0x04,0x00,0x2C,0x5C,0x55,0x5D,0x49,0x4C,0x45,0x53,0x03,0x00,0x00,0x00,
		0x12,0x00,0x00,0x00,0x67,0x80,0x25,0xA4,0x09,0x00,0x06,0x00,0x03,0x00,0x01,0x00,
		0x04,0x00,0x60,0xC9,0x14,0xFD,0x49,0x4C,0x45,0x53,0x04,0x00,0x00,0x00,0x12,0x00,
		0x00,0x00,0x9A,0x2F,0x3D,0x31,0x09,0x00,0x04,0x00,0x17,0x00,0x08,0x00,0x04,0x00,
		0x60,0xC9,0x14,0xFD,0x49,0x4A,0x42,0x4F,0x00,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,
		0x07,0x00,0xF9,0xBE,0xE6,0x81,0xE7,0x03,0x01,0x00,0x5F,0x4A,0x42,0x4F,0x07,0x00,
		0x00,0x00,0x89,0x00,0x00,0x00,0x2A,0x01,0x00,0x00,0x85,0x00,0x00,0x00,0x10,0xFB,
		0x00,0x01,0x2A,0xE0,0x07,0x00,0x00,0x00,0x01,0x03,0xC8,0xE0,0x88,0x02,0x00,0x00,
		0x01,0x07,0xB8,0x01,0x07,0x78,0x01,0x03,0x80,0x01,0x0B,0xC0,0x01,0x03,0x01,0x01,
		0x03,0x08,0x8A,0x00,0x00,0x8E,0x00,0x11,0x11,0x07,0x48,0x06,0x31,0xFF,0xFF,0x04,
		0x00,0x09,0x05,0x04,0x04,0x5B,0x04,0x15,0x8C,0x00,0x2F,0x09,0x59,0x02,0x98,0x00,
		0x00,0xE0,0xA0,0x20,0x00,0x00,0x03,0x09,0x03,0x01,0x10,0xE0,0xCD,0x07,0x06,0x00,
		0x01,0x07,0x0F,0x9B,0x40,0x31,0x32,0x8C,0x00,0x61,0x08,0x00,0x04,0x40,0x08,0x00,
		0xE0,0xF9,0xBE,0xE6,0x81,0x03,0x76,0x00,0x00,0x18,0x87,0xC0,0x11,0x01,0xE8,0x03,
		0x0C,0xE3,0xE0,0x00,0x00,0x11,0x11,0x12,0x33,0xFF,0xFF,0x95,0x00,0x00,0xFC,0x50,
		0x6A,0x62,0x6F,0x07,0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,
		0x00,0x49,0x4A,0x42,0x4F,0x01,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x06,0x00,0x9A,
		0x2F,0x3D,0x31,0x02,0x00,0x01,0x00,0x5F,0x4A,0x42,0x4F,0x06,0x00,0x00,0x00,0x89,
		0x00,0x00,0x00,0x42,0x01,0x00,0x00,0x85,0x00,0x00,0x00,0x10,0xFB,0x00,0x01,0x42,
		0xE0,0x07,0x00,0x00,0x00,0x01,0x03,0xA8,0xE0,0x88,0x02,0x00,0x00,0x01,0x07,0x98,
		0x01,0x07,0x78,0x01,0x03,0x80,0x01,0x0B,0xA0,0x01,0x03,0x01,0x01,0x03,0x10,0x9A,
		0x00,0x00,0x8D,0x40,0x11,0x08,0x11,0x07,0x48,0x06,0x41,0xFF,0xFF,0x1C,0x00,0x11,
		0x15,0x06,0x8C,0x00,0x2F,0x09,0x69,0x02,0x99,0xC0,0x67,0x00,0x00,0x05,0x09,0x8B,
		0x03,0xE0,0xCD,0x07,0x06,0x00,0x01,0x07,0x0F,0x8D,0x40,0x1F,0x32,0x11,0x45,0x01,
		0x04,0x4F,0x8E,0x00,0x61,0x08,0x00,0x00,0x40,0x89,0x40,0x17,0x04,0xE0,0x9A,0x2F,
		0x3D,0x31,0x03,0x38,0x00,0x00,0x18,0x88,0x80,0x11,0x01,0x03,0x0C,0xFB,0xE0,0x00,
		0x00,0x11,0x11,0x8E,0x80,0x4D,0xFF,0xFF,0x8A,0x00,0x00,0xFC,0x50,0x6A,0x62,0x6F,
		0x06,0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x49,0x4A,
		0x42,0x4F,0x02,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x05,0x00,0x67,0x80,0x25,0xA4,
		0x1F,0x4E,0x01,0x00,0x5F,0x4A,0x42,0x4F,0x05,0x00,0x00,0x00,0x91,0x00,0x00,0x00,
		0x34,0x01,0x00,0x00,0x8D,0x00,0x00,0x00,0x10,0xFB,0x00,0x01,0x34,0xE0,0x07,0x00,
		0x00,0x00,0x01,0x03,0xA8,0xE0,0x48,0x02,0x00,0x00,0x01,0x07,0x98,0x01,0x07,0x38,
		0x01,0x03,0x40,0x01,0x0B,0xA0,0x01,0x03,0x01,0x01,0x03,0x08,0x8A,0x00,0x00,0x8E,
		0x00,0x11,0x11,0x07,0x48,0x06,0x31,0xFF,0xFF,0x1C,0x00,0x11,0x15,0x05,0x8C,0x00,
		0x2F,0x09,0x59,0x02,0x8D,0xC0,0x49,0x00,0x00,0x3C,0x14,0x11,0xE0,0x80,0x20,0x00,
		0x00,0x03,0x09,0x03,0x00,0x12,0xE0,0xCD,0x07,0x06,0x00,0x01,0x07,0x0F,0x8D,0x40,
		0x2B,0x32,0x8E,0x00,0x00,0x1C,0x7D,0x00,0xC0,0x04,0x00,0xE0,0x10,0x00,0x00,0x04,
		0x89,0x00,0x21,0xE0,0x67,0x80,0x25,0xA4,0x03,0x28,0x00,0x00,0x18,0x87,0xC0,0x11,
		0x01,0x20,0x4E,0x18,0x31,0xE0,0x00,0x11,0x11,0xFF,0x15,0x0B,0xFF,0x94,0x00,0x00,
		0xFC,0x50,0x6A,0x62,0x6F,0x05,0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x01,0x00,0x00,
		0x00,0x00,0x00,0x49,0x4A,0x42,0x4F,0x03,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x04,
		0x00,0x74,0x19,0x12,0xEF,0x0F,0x27,0x01,0x00,0x5F,0x4A,0x42,0x4F,0x04,0x00,0x00,
		0x00,0x95,0x00,0x00,0x00,0x48,0x01,0x00,0x00,0x91,0x00,0x00,0x00,0x10,0xFB,0x00,
		0x01,0x48,0xE0,0x07,0x00,0x00,0x00,0x01,0x03,0xB8,0xE0,0x08,0x02,0x00,0x00,0x01,
		0x07,0xA8,0x02,0x04,0xF8,0x01,0x00,0x0B,0x01,0x06,0xB0,0x04,0x0A,0x03,0x05,0x08,
		0x00,0x03,0x01,0x03,0x0F,0x14,0x00,0x1D,0x0A,0x08,0x10,0x00,0x11,0x07,0x48,0x06,
		0x31,0xFF,0xFF,0x1C,0x00,0x11,0x15,0x04,0x8C,0x00,0x2F,0x09,0x59,0x02,0xE0,0x00,
		0x00,0xFA,0x00,0x19,0x13,0x32,0x1C,0x09,0x04,0x00,0x03,0x77,0x80,0x20,0x00,0x01,
		0x09,0x12,0x0B,0x7D,0xCD,0x07,0x06,0x8A,0x00,0x1F,0x92,0x00,0x00,0x1C,0x7D,0x00,
		0xC0,0x00,0x00,0x16,0x0F,0x0E,0x10,0xE0,0x74,0x19,0x12,0xEF,0x03,0x20,0x00,0x00,
		0x18,0x87,0xC0,0x11,0x01,0x10,0x27,0x14,0x29,0xE0,0x00,0x00,0x11,0x11,0x16,0x0B,
		0xFF,0xFF,0xA2,0x00,0x63,0x1C,0x0B,0x24,0x21,0xFC,0x50,0x6A,0x62,0x6F,0x04,0x00,
		0x00,0x00,0x06,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x49,0x4A,0x42,0x4F,
		0x04,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x03,0x00,0x42,0x48,0x9C,0x72,0x0F,0x27,
		0x01,0x00,0x5F,0x4A,0x42,0x4F,0x03,0x00,0x00,0x00,0x96,0x00,0x00,0x00,0x48,0x01,
		0x00,0x00,0x92,0x00,0x00,0x00,0x10,0xFB,0x00,0x01,0x48,0xE0,0x07,0x00,0x00,0x00,
		0x01,0x03,0xA8,0xE0,0x08,0x02,0x00,0x00,0x01,0x07,0x98,0x02,0x04,0xF8,0x01,0x00,
		0x0B,0x01,0x06,0xA0,0x04,0x0A,0x03,0x05,0x08,0x00,0x03,0x01,0x03,0x0F,0x14,0x00,
		0x1D,0x0A,0x08,0x10,0x00,0x11,0x07,0x48,0x06,0x31,0xFF,0xFF,0x04,0x00,0x09,0x05,
		0x04,0x04,0x39,0x04,0x15,0x8C,0x00,0x2F,0x09,0x59,0x02,0xE0,0x00,0x00,0xFA,0x00,
		0x19,0x13,0x32,0x11,0x13,0x32,0x0C,0x00,0x06,0x3D,0x80,0x20,0x01,0x09,0x12,0x0B,
		0x7D,0xCD,0x07,0x06,0x1C,0x29,0x96,0x00,0x00,0x1C,0x41,0x00,0xC0,0x00,0x00,0x16,
		0x0F,0x0E,0x10,0xE0,0x42,0x48,0x9C,0x72,0x03,0x20,0x00,0x00,0x18,0x87,0xC0,0x11,
		0x01,0x10,0x27,0x14,0x29,0xE0,0x00,0x00,0x11,0x11,0x16,0x0B,0xFF,0xFF,0xAE,0x00,
		0x00,0xFE,0x04,0x00,0x50,0x6A,0x62,0x6F,0x03,0x00,0x00,0x00,0x06,0x00,0x00,0x00,
		0x01,0x00,0x00,0x00,0x00,0x00,0x44,0x4F,0x4D,0x4F,0x01,0x00,0x00,0x00,0x0B,0x00,
		0x00,0x00,0x04,0x00,0x00,0x00,0x05,0x00,0x05,0x00,0x00,0x00,0x00,0x52,0x47,0x4D,
		0x46,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x52,0x47,0x4D,
		0x57,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x44,0x49,0x53,
		0x48,0x00,0x00,0x00,0x00,0x09,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xD5,0x00,0xB8,
		0x00,0x01,0x43,0x53,0x44,0x48,0x00,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x02,0x36,
		0x30,0x06,0x73,0x6C,0x61,0x74,0x65,0x31,0x54,0x4D,0x52,0x48,0x00,0x00,0x00,0x00,
		0x08,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x11,0x11,0xFF,0xFF,0x45,0x54,0x52,0x48,
		0x00,0x00,0x00,0x00,0x13,0x00,0x00,0x00,0x34,0x00,0x00,0x00,0x0F,0x00,0x00,0x00,
		0x10,0xFB,0x00,0x00,0x34,0xAE,0x80,0x00,0x05,0x00,0xFC,0x4E,0x42,0x4D,0x41,0x00,
		0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,
		0x00,0xB8,0x00,0xD5
	};

	printf("Reached client_handle_house_sim_constraints_pdu.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));

	client->is_joined = 1;
}

static void client_handle_load_avatar_by_id_request(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0xF3,0x01,0x00,0x00,

		/* LoadAvatarByID response packet */
		0x27,0x12,
		0x00,0x00,0x01,0xF3,
		0xFE,0xED,0xF0,0x0D,
		0x80,0x00,0x00,0x00,
		0x80,0x00,0x00,0x00,
		0x00,
		0x00,
		0x00,0x00,0x01,0xDB,
		0x12,0x51,0x94,0xE5,
		0x10,0x64,0x00,0x27,
		0xFE,0xED,0xF0,0x0D,
		0xFF,
		0xDB,0xF3,0x01,0xA9,
		0x8A,0xDF,0x86,0x5D,
		0x00,0x00,0x05,0x39,
		0x8A,0xDF,0x86,0x5D,
		0x2A,0xDF,0x8F,0xF5,
		0x00,0x00,0x05,0x39,0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x53,0x69,0x6D,0x01,0x42,0x10,
		0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,
		0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,
		0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x3F,0x40,
		0x41,0x42,0x43,0x00,0x00,0x46,0x47,0x48,0x49,0x4A,0x4B,0x4C,0x4D,0x4E,0x4F,0x50,
		0x51,0x52,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x33,0x41,0x31,0x30,0x30,0x30,
		0x30,0x30,0x30,0x30,0x44,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x32,0x34,0x41,
		0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x44,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,
		0x32,0x42,0x37,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x44,0x12,0x30,0x78,0x30,0x30,
		0x30,0x30,0x30,0x32,0x42,0x36,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x44,0x12,0x30,
		0x78,0x30,0x30,0x30,0x30,0x30,0x32,0x34,0x45,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
		0x44,0x54,0x55,0x56,0x57,0x58,0x59,0x5A,0x5B,0x5C,0x5D,0x5E,0x5F,0x60,0x61,0x62,
		0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x00,0x00,0x6C,0x6D,0x6E,0x6F,0x70,0x71,0x72,
		0x73,0x74,0x75,0x76,0x77,0x00,0x00,0x00,0x01,0x7C,0x7D,0x7E,0x7F,0x80,0x81,0x82,
		0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,0x01,0x48,0x00,
		0x00,0x00,0x01,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,0x00,
		0x00,0x00,0x01,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0x00,0x00,0x00,0x01,0xB1,
		0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,0xC0,0xC1,
		0xC2,0xC3,0xC4,0xC5,0xC6,0x00,0x00,0x00,0x01,0xCB,0xCC,0xCD,0xCE,0xCF,0xD0,0xD1,
		0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF,0xE0,0xE1,
		0xE2,0xE3,0xE4,0x00,0x00,0x00,0x01,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF,0xF0,0xF1,
		0xF2,0xF3,0xF4,0xF5,0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF,0x80,0x81,
		0x82,0x00,0x00,0x00,0x01,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,0x90,0x91,
		0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x00,0x00,0x00,0x01,0x70,
		0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x7A,0x7B,0x7C,0x7D,0x7E,0x7F,0x60,
		0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C,0x6D,0x6E,0x6F,0x50,
		0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x69,0xF4,0xD5,0xE8,0x5E,0x5F,0x40,
		0x41,0x04,0x20,0x21,0x22,0x23,0x10,0x11,0x12,0x13
	};

	printf("Reached client_handle_load_avatar_by_id_request.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

/*
** client_handle_buy_object_request
** Send a BuyObject response which, for each object specified in the
** HouseSimServer's BuyObject request, approves the creation of that object.
**
** The BuyObjectRequest format is as such (some fields have been supplied names):
** (*) dword1
** (*) dword2: avatarid
** (*) dword3
** (*) dword4
** (*) dword5: transaction id
** (*) dword: object count
** (*) objects - for each object:
**   (*) qword: dbid
**   (*) dword: unknown 1
**   (*) dword: avatarid
**   (*) short: unknown 2
**   (*) short: unknown 3
**   (*) dword: object guid
**   (*) short: object id
**   (*) string: object_name
**   (*) dword
**   (*) dword
**   (*) qword
**   (*) qword
**   (*) cTSOSerializableStream
** (*) 10 dwords
**
** The BuyObjectResponse format is as such:
** (*) dword1 \
** (*) dword2  | These 5 dwords should be copied verbatim from the server's request packet.
** (*) dword3  | The last field (dword5) changes with each of the server's requests and is generally
** (*) dword4  | random with each program run.
** (*) dword5 /
** (*) dword: object count
** (*) objects - for each object:
**   (*) qword: dbid        \
**   (*) dword: unknown 1    | These fields should also be copied from the request packet.
**   (*) dword: avatarid     |
**   (*) dword: object guid  |
**   (*) short: object id   /
** (*) 10 dwords -- The game ignores these 10 fields except for the last two fields, which
**                  should be 0x69f4d5e8 followed by 0x00000000.
**
** Since the response packet is never larger than the request packet,
** we simply modify the request packet in place and then forward it to the HouseSimServer.
*/
static void client_handle_buy_object_request(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	struct ByteStream in, out;
	uint8_t aries_header[12] = {0};
	uint32_t object_count;

	if (voltron_size < 81)
		return;

	printf("Reached client_handle_buy_object_request.\n");
	object_count = READ32BE(voltron_data+77);

	if (object_count > 64) {
		fprintf(stderr, "error: object_count = %u is too large\n", object_count);
		exit(EXIT_FAILURE);
	}

	/* Update the message id. */
	WRITE32BE(voltron_data+49, 0x2BFB0269);

	/* Update the clsid. */
	WRITE32BE(voltron_data+53, 0x4BFD8A12);

	/* At this point, we need to use bytestreams to parse the objects in the
	** request packet and to write out the objects in the response packet. */
	in.data = out.data = voltron_data;
	in.size = out.size = voltron_size;
	in.position = out.position = 81;

	while (object_count--) {
		uint32_t dbid_high, dbid_low, unknown_1, avatarid, object_guid, objectid;
		uint32_t size;

		/* The first several fields (excluding one) are copied to the response packet. */
		dbid_high = bytestream_read32be(&in);
		dbid_low = bytestream_read32be(&in);
		unknown_1 = bytestream_read32be(&in);
		avatarid = bytestream_read32be(&in);
		bytestream_read32be(&in); /* do not copy this field to the response packet */
		object_guid = bytestream_read32be(&in);
		objectid = bytestream_read16be(&in);
		bytestream_write32be(&out, dbid_high);
		bytestream_write32be(&out, dbid_low);
		bytestream_write32be(&out, unknown_1);
		bytestream_write32be(&out, avatarid);
		bytestream_write32be(&out, object_guid);
		bytestream_write16be(&out, objectid);

		/* Skip to the next object in the request packet. */
		size = bytestream_read8(&in);
		bytestream_skip(&in, size);
		bytestream_skip(&in, 24);
		if (bytestream_read8(&in) == 0) {
			/* Uncompressed cTSOSerializableStream */
			size = bytestream_read32be(&in); /* decompressed size */
			bytestream_skip(&in, size);
		} else {
			/* Compressed cTSOSerializableStream */
			bytestream_read32be(&in); /* decompressed size */
			size = bytestream_read32be(&in); /* compressed size */
			bytestream_skip(&in, size);
		}
	}

	/* Write out the final 10 dwords. */
	bytestream_write32be(&out, 0xbaadf00d); bytestream_write32be(&out, 0xbaadf00d);
	bytestream_write32be(&out, 0xbaadf00d); bytestream_write32be(&out, 0xbaadf00d);
	bytestream_write32be(&out, 0xbaadf00d); bytestream_write32be(&out, 0xbaadf00d);
	bytestream_write32be(&out, 0xbaadf00d); bytestream_write32be(&out, 0xbaadf00d);
	bytestream_write32be(&out, 0x69f4d5e8); bytestream_write32be(&out, 0x00000000);

	/* We are done; the new size of the Voltron packet is given by out.position.
	** Update the size fields, and forward the packet to the HouseSimServer. */
	WRITE32LE(aries_header+8, out.position);
	WRITE32BE(voltron_data+2, out.position);
	WRITE32BE(voltron_data+32, out.position-36);
	bufferevent_write(client->bev, aries_header, 12);
	bufferevent_write(client->bev, out.data, out.position);
}

/*
** client_handle_sell_object_request
** Send a SellObject response which approves the deletion of the given object.
**
** The SellObjectRequest format is as such (some fields have been supplied names):
** (*) dword1
** (*) dword: object count
** (*) objects - for each object
**   (*) qword: dbid
** (*) dword2: avatarid
** (*) dword3
** (*) dword4
** (*) dword5: transaction id
** (*) 10 dwords
**
** The SellObjectResponse format is as such:
** (*) dword1 \
** (*) dword2  | These 5 dwords should be copied verbatim from the server's request packet.
** (*) dword3  | The last field (dword5) changes with each of the server's requests and is generally
** (*) dword4  | random with each program run.
** (*) dword5 /
** (*) 10 dwords -- The game ignores these 10 fields except for the last two fields, which
**                  should be 0x69f4d5e8 followed by 0x00000000.
**
** Since the response packet is never larger than the request packet,
** we simply modify the request packet in place and then forward it to the HouseSimServer.
*/
static void client_handle_sell_object_request(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	uint32_t object_count;
	uint8_t aries_header[12] = {0};
	uint8_t ten_dwords[40] = {
		0xBA,0xAD,0xF0,0x0D,0xBA,0xAD,0xF0,0x0D,
		0xBA,0xAD,0xF0,0x0D,0xBA,0xAD,0xF0,0x0D,
		0xBA,0xAD,0xF0,0x0D,0xBA,0xAD,0xF0,0x0D,
		0xBA,0xAD,0xF0,0x0D,0xBA,0xAD,0xF0,0x0D,
		0x69,0xF4,0xD5,0xE8,0x00,0x00,0x00,0x00
	};

	if (voltron_size < 117)
		return;

	printf("Reached client_handle_sell_object_request.\n");
	object_count = READ32BE(voltron_data+61);

	if (object_count > 64) {
		fprintf(stderr, "error: object_count = %u is too large\n", object_count);
		exit(EXIT_FAILURE);
	}

	/* Write out dword2-dword5, by skipping over the object_count field, as well as the
	** (object_count) dbid fields, from the packet. */
	if (61+4+object_count*8+16 > voltron_size)
		return;
	memmove(voltron_data+61, voltron_data+61+4+object_count*8, 16);

	/* Update the message id. */
	WRITE32BE(voltron_data+49, 0x4BFB026E);

	/* Update the clsid. */
	WRITE32BE(voltron_data+53, 0x8BFD895F);

	/* Write out the final 10 dwords. */
	memcpy(voltron_data+77, ten_dwords, 40);

	/* Update the size fields, and forward the packet to the HouseSimServer. */
	WRITE32LE(aries_header+8, 117);
	WRITE32BE(voltron_data+2, 117);
	WRITE32BE(voltron_data+32, 81);
	bufferevent_write(client->bev, aries_header, 12);
	bufferevent_write(client->bev, voltron_data, 117);
}

static void client_handle_db_request_wrapper_pdu(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	uint32_t clsid;

	if (voltron_size < 57)
		return;

	clsid = READ32BE(voltron_data+53);
	printf("client_handle_db_request_wrapper_pdu: Received clsid 0x%08X\n", clsid);
	switch (clsid) {
	case 0x2ADF7EED: client_handle_load_avatar_by_id_request(client); break;
	case 0x4BFD8A1B: client_handle_buy_object_request(client, voltron_data, voltron_size); break;
	case 0x8BFD896A: client_handle_sell_object_request(client, voltron_data, voltron_size); break;
	}
}

static void client_handle_my_avatar_request(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x37,0x01,0x00,0x00, /* hex: 40+50+6c+3b= 137 */

		/* MyAvatar.Avatar_Name packet */
		0x27,0x34,
		0x00,0x00,0x00,0x40,
		0xFE,0xED,0xF0,0x0D,
		0xA4,0x6E,0x47,0xDC,
		0x00,0x00,0x00,0x2E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x4F,0xFE,0x27,0x0C,
		0x89,0x6D,0x16,0x88,
		0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x53,0x69,0x6D, /* "JollySim" */
		0x00,

		/* MyAvatar.Avatar_Description packet */
		0x27,0x34,
		0x00,0x00,0x00,0x50,
		0xFE,0xED,0xF0,0x0D,
		0xA4,0x6E,0x47,0xDC,
		0x00,0x00,0x00,0x3E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x54,0xB9,0x9C,0x9A,
		0x89,0x6D,0x16,0x88,
		0x18,0x42,0x65,0x61,0x72,0x2D,0x79,0x20,0x6e,0x69,0x63,0x65,0x20,0x74,0x6f,0x20,
		0x6d,0x65,0x65,0x74,0x20,0x79,0x6f,0x75,0x21, /* "Bear-y nice to meet you!" */
		0x00,

		/* MyAvatar.Avatar_Appearance packet */
		0x27,0x34,
		0x00,0x00,0x00,0x6C,
		0xFE,0xED,0xF0,0x0D,
		0xA4,0x6E,0x47,0xDC,
		0x00,0x00,0x00,0x5A,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0xF1,0xB9,0x2C,0x99,
		0xA9,0x6E,0x7E,0x5B,
		0x89,0x73,0x9A,0x79,
		0x3B,0x04,0x30,0xBF,
		0x00,0x00,0x00,0x03,
		0x1D,0x53,0x02,0x75,
		0x69,0xD3,0xE3,0xDB,
		0x00,0x00,0x01,0x60,0x00,0x00,0x00,0x0D, /* body outfit */
		0x25,0x11,0xB2,0x9C,
		0xC9,0x76,0x08,0x7C,
		0x00,
		0x68,0x74,0x75,0xBF,
		0x69,0xD3,0xE3,0xDB,
		0x00,0x00,0x04,0x0F,0x00,0x00,0x00,0x0D, /* head outfit */
		0x00,

		/* MyAvatar.Avatar_LotGridXY packet */
		0x27,0x34,
		0x00,0x00,0x00,0x3B,
		0xFE,0xED,0xF0,0x0D,
		0xA4,0x6E,0x47,0xDC,
		0x00,0x00,0x00,0x29,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x7E,0x0D,0xD3,0x5C,
		0x69,0x6D,0x11,0x89,
		0x00,0xB8,0x00,0xD5,
		0x00
	};

	printf("Reached client_handle_my_avatar_request.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void client_handle_sim_page_main_request(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x1f,0x01,0x00,0x00, /* hex: 40+3b+38+6c= 11f */

		/* SimPage_Main.Avatar_Name packet */
		0x27,0x34,
		0x00,0x00,0x00,0x40,
		0xFE,0xED,0xF0,0x0D,
		0xD0,0x42,0xE9,0xD6,
		0x00,0x00,0x00,0x2E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x4F,0xFE,0x27,0x0C,
		0x89,0x6D,0x16,0x88,
		0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x53,0x69,0x6D, /* "JollySim" */
		0x00,

		/* SimPage_Main.Avatar_LotGridXY packet */
		0x27,0x34,
		0x00,0x00,0x00,0x3B,
		0xFE,0xED,0xF0,0x0D,
		0xD0,0x42,0xE9,0xD6,
		0x00,0x00,0x00,0x29,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x7E,0x0D,0xD3,0x5C,
		0x69,0x6D,0x11,0x89,
		0x00,0xB8,0x00,0xD5,
		0x00,

		/* SimPage_Main.Avatar_IsOnline packet */
		0x27,0x34,
		0x00,0x00,0x00,0x38,
		0xFE,0xED,0xF0,0x0D,
		0xD0,0x42,0xE9,0xD6,
		0x00,0x00,0x00,0x26,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0xAB,0x13,0x12,0xD4,
		0x69,0x6D,0x11,0x83,
		0x01, /* 1 for online */
		0x00,

		/* SimPage_Main.Avatar_Appearance packet */
		0x27,0x34,
		0x00,0x00,0x00,0x6C,
		0xFE,0xED,0xF0,0x0D,
		0xD0,0x42,0xE9,0xD6,
		0x00,0x00,0x00,0x5A,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0xF1,0xB9,0x2C,0x99,
		0xA9,0x6E,0x7E,0x5B,
		0x89,0x73,0x9A,0x79,
		0x3B,0x04,0x30,0xBF,
		0x00,0x00,0x00,0x03,
		0x1D,0x53,0x02,0x75,
		0x69,0xD3,0xE3,0xDB,
		0x00,0x00,0x01,0x60,0x00,0x00,0x00,0x0D, /* body outfit */
		0x25,0x11,0xB2,0x9C,
		0xC9,0x76,0x08,0x7C,
		0x00,
		0x68,0x74,0x75,0xBF,
		0x69,0xD3,0xE3,0xDB,
		0x00,0x00,0x04,0x0F,0x00,0x00,0x00,0x0D, /* head outfit */
		0x00
	};

	printf("Reached client_handle_sim_page_main_request.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void client_handle_thumbnail_avatar_request(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x1f,0x01,0x00,0x00, /* hex: 40+3b+38+6c= 11f */

		/* Thumbnail_Avatar.Avatar_Name packet */
		0x27,0x34,
		0x00,0x00,0x00,0x40,
		0xFE,0xED,0xF0,0x0D,
		0x90,0x62,0xB3,0x90,
		0x00,0x00,0x00,0x2E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x4F,0xFE,0x27,0x0C,
		0x89,0x6D,0x16,0x88,
		0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x53,0x69,0x6D, /* "JollySim" */
		0x00,

		/* Thumbnail_Avatar.Avatar_LotGridXY packet */
		0x27,0x34,
		0x00,0x00,0x00,0x3B,
		0xFE,0xED,0xF0,0x0D,
		0x90,0x62,0xB3,0x90,
		0x00,0x00,0x00,0x29,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0x7E,0x0D,0xD3,0x5C,
		0x69,0x6D,0x11,0x89,
		0x00,0xB8,0x00,0xD5,
		0x00,

		/* Thumbnail_Avatar.Avatar_IsOnline packet */
		0x27,0x34,
		0x00,0x00,0x00,0x38,
		0xFE,0xED,0xF0,0x0D,
		0x90,0x62,0xB3,0x90,
		0x00,0x00,0x00,0x26,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0xAB,0x13,0x12,0xD4,
		0x69,0x6D,0x11,0x83,
		0x01, /* 1 for online */
		0x00,

		/* Thumbnail_Avatar.Avatar_Appearance packet */
		0x27,0x34,
		0x00,0x00,0x00,0x6C,
		0xFE,0xED,0xF0,0x0D,
		0x90,0x62,0xB3,0x90,
		0x00,0x00,0x00,0x5A,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x05,0x60,0x03,0x32,
		0x00,0x00,0x05,0x39,
		0xF1,0xB9,0x2C,0x99,
		0xA9,0x6E,0x7E,0x5B,
		0x89,0x73,0x9A,0x79,
		0x3B,0x04,0x30,0xBF,
		0x00,0x00,0x00,0x03,
		0x1D,0x53,0x02,0x75,
		0x69,0xD3,0xE3,0xDB,
		0x00,0x00,0x01,0x60,0x00,0x00,0x00,0x0D, /* body outfit */
		0x25,0x11,0xB2,0x9C,
		0xC9,0x76,0x08,0x7C,
		0x00,
		0x68,0x74,0x75,0xBF,
		0x69,0xD3,0xE3,0xDB,
		0x00,0x00,0x04,0x0F,0x00,0x00,0x00,0x0D, /* head outfit */
		0x00
	};

	printf("Reached client_handle_thumbnail_avatar_request.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void client_handle_current_city_request(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x7F,0x00,0x00,0x00,

		/* CurrentCity.City_ReservedLotInfo packet */
		0x27,0x34,
		0x00,0x00,0x00,0x40,
		0xFE,0xED,0xF0,0x0D,
		0xE4,0xE9,0xB2,0x5D,
		0x00,0x00,0x00,0x2E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0xED,0x56,0xD0,0x57,
		0x00,0x00,0x00,0x00,
		0xA2,0xAE,0x32,0x82,
		0xC9,0x77,0x57,0xF5,
		0x00,0x00,0x00,0x01,
		0x00,0xB8,0x00,0xD5,
		0x01,
		0x00,

		/* CurrentCity.City_SpotlightsVector packet */
		0x27,0x34,
		0x00,0x00,0x00,0x3F,
		0xFE,0xED,0xF0,0x0D,
		0xE4,0xE9,0xB2,0x5D,
		0x00,0x00,0x00,0x2D,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0xED,0x56,0xD0,0x57,
		0x00,0x00,0x00,0x00,
		0xC7,0x40,0xD3,0xA9,
		0x89,0x73,0x84,0x96,
		0x00,0x00,0x00,0x01,
		0x00,0xB8,0x00,0xD5,
		0x00
	};

	printf("Reached client_handle_current_city_request.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void client_handle_property_page_request(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xFF,0xFF,0xFF,0xFF,
		0x73,0x08,0x00,0x00, /* hex: 38+6d5+38+3b+40+40+3b+38= 873 */

		/* PropertyPage_LotInfo.Lot_NumOccupants packet */
		0x27,0x34,
		0x00,0x00,0x00,0x38,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x26,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0x0D,0x6B,0xA8,0xA1,
		0xC9,0x76,0x08,0x7C,
		0x00, /* 0 occupants */
		0x00,

		/* PropertyPage_LotInfo.Lot_Thumbnail packet */
		0x27,0x34,
		0x00,0x00,0x06,0xD5,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x06,0xC3,
		0x12,0x51,0x94,0xE5,
		0xFF,0xFF,0xFF,0xFF,
		0xFE,0xED,0xF0,0x0D,
		0xFF,
		0x8A,0x27,0x26,0xE0,
		0xDA,0xDD,0xE5,0x11,
		0xDA,0xDD,0xE5,0x12,
		0xDA,0xDD,0xE5,0x13,
		0x09,0x73,0x60,0x27,
		0x0D,0x68,0x80,0x32,
		0x8A,0x27,0x26,0xE0,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0x2E,0xCC,0x92,0xD1,
		0xA9,0x9A,0xF3,0xB7,
		0x0A,0x2C,0x65,0x85,
		0x00,0x00,0x06,0x70,
		/* When the 0xffff1111 field in the HouseData packet is changed to 0x00000539,
		** the client begins to save the lot thumbnail as
		** UserData/HouseThumbnails/City%d/%d.png whenever the player switches from
		** Buy Mode to Live Mode.
		** Using this method, the following PNG thumbnail was generated. */
		0x89,0x50,0x4E,0x47,0x0D,0x0A,0x1A,0x0A,0x00,0x00,0x00,0x0D,0x49,0x48,0x44,0x52,
		0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x40,0x08,0x03,0x00,0x00,0x00,0xE5,0x08,0x8F,
		0x4D,0x00,0x00,0x03,0x00,0x50,0x4C,0x54,0x45,0x00,0x00,0x00,0x10,0x18,0x08,0x08,
		0x18,0x28,0x00,0x08,0x10,0x10,0x18,0x30,0x10,0x1C,0x28,0x18,0x24,0x20,0x08,0x10,
		0x08,0x18,0x24,0x28,0x08,0x0C,0x18,0x20,0x2C,0x30,0x10,0x1C,0x18,0x08,0x0C,0x08,
		0x18,0x18,0x10,0x00,0x04,0x00,0x10,0x14,0x10,0x18,0x1C,0x18,0x20,0x20,0x20,0x20,
		0x28,0x28,0x10,0x18,0x10,0x10,0x04,0x10,0x10,0x20,0x28,0x20,0x24,0x18,0x10,0x14,
		0x08,0x28,0x34,0x38,0x18,0x1C,0x10,0x18,0x28,0x28,0x20,0x28,0x20,0x18,0x20,0x18,
		0x18,0x28,0x20,0x10,0x1C,0x10,0x10,0x1C,0x30,0x00,0x08,0x00,0x18,0x20,0x10,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xA0,0xCA,0xE7,0x4C,0x00,0x00,0x01,
		0x00,0x74,0x52,0x4E,0x53,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
		0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
		0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0xE1,0xE9,0xFD,0xE4,0x00,0x00,0x02,0x1F,0x49,0x44,0x41,
		0x54,0x78,0x9C,0xE5,0x99,0x6B,0x57,0x83,0x30,0x0C,0x86,0x2B,0x88,0xDB,0x74,0xA3,
		0x38,0xC5,0x39,0x1D,0xA2,0xFF,0xFF,0x4F,0xBA,0x3A,0x39,0x92,0x90,0x5E,0x93,0x76,
		0x1F,0x7C,0xCE,0xD1,0x0F,0x1B,0x25,0x97,0xBE,0x49,0x3A,0x50,0x2A,0x92,0xCD,0x48,
		0x51,0xC5,0xDE,0x26,0x95,0x8A,0x34,0x6F,0x68,0x4A,0x98,0xA7,0xA3,0x2F,0x96,0x05,
		0x7B,0xF4,0x45,0xB2,0xE0,0x37,0x9F,0xD5,0x05,0x94,0xFC,0xBE,0x1B,0xF4,0x5E,0xDF,
		0xE9,0xE1,0xD4,0x0D,0xEF,0x05,0x36,0x02,0x45,0xFF,0x86,0xBE,0x3E,0x34,0x79,0xB3,
		0x00,0xA2,0x1F,0x54,0x4B,0x5C,0xD2,0xAA,0x6D,0xB6,0x2C,0x54,0xD0,0xBC,0x83,0x2C,
		0x59,0x00,0xE6,0x6F,0x7C,0x57,0xF7,0xD2,0x2E,0x80,0xE4,0xE3,0x9D,0xA7,0x38,0x88,
		0x6E,0x04,0x88,0xFE,0x29,0x70,0x51,0x3B,0x17,0x24,0x2B,0x0B,0x50,0xD9,0x63,0xF0,
		0xBA,0x75,0xE2,0x3A,0x04,0xAA,0x7B,0xA7,0xF8,0x10,0x5B,0xB8,0x34,0x69,0x23,0xAA,
		0x74,0xF3,0x84,0x0B,0xD1,0x1B,0x01,0xA5,0x37,0xC4,0x9A,0x37,0x74,0x7B,0x9D,0x9C,
		0x85,0x24,0xE9,0x51,0xA4,0xC9,0xB1,0x11,0x30,0xFF,0x79,0xB1,0xAF,0x60,0x5F,0x08,
		0x92,0x23,0x94,0x5E,0x9F,0x66,0xFF,0x97,0x57,0xE3,0x44,0x9C,0x1C,0x99,0xD2,0x43,
		0x3C,0x9F,0xFF,0xEE,0x63,0xE4,0x88,0xEA,0xDE,0xDB,0x76,0x43,0xB8,0x53,0x70,0x42,
		0x38,0x36,0xC2,0x33,0x70,0x13,0x79,0x34,0xFF,0x0E,0xF0,0xD6,0x64,0x16,0x90,0x79,
		0x8E,0xF6,0x29,0x5A,0x4F,0x57,0x05,0xD2,0x6B,0x98,0xDA,0xA3,0x79,0x19,0x81,0x0F,
		0x40,0x8E,0x71,0x03,0x97,0x83,0x65,0x23,0x66,0x9F,0x52,0x67,0x1D,0x51,0xC8,0xBE,
		0x20,0x2D,0x3C,0x27,0x5F,0x44,0x16,0xEC,0xDA,0xC8,0xC0,0x07,0x51,0x11,0xD7,0x74,
		0xE0,0xCC,0xA6,0xAC,0x03,0xA7,0x85,0x03,0xD5,0x3F,0x73,0x60,0xBD,0x70,0x60,0xBC,
		0xAE,0x03,0x46,0x85,0x63,0x41,0x0F,0x90,0xFD,0x4B,0x43,0x9C,0x7F,0x92,0xA3,0x0B,
		0xFF,0x71,0x5C,0x46,0x8F,0x1D,0xC8,0xDB,0x0B,0x89,0xE8,0x7F,0xA8,0xCB,0xE4,0xE0,
		0x68,0x31,0x6F,0x98,0xCD,0xA3,0x5B,0xF1,0x59,0x7C,0x01,0x1C,0xCE,0x88,0x23,0x41,
		0xED,0xF9,0x9E,0xC9,0xCE,0x11,0xFD,0x04,0x98,0xCA,0x0F,0xA2,0xE6,0x43,0xCF,0xE7,
		0x50,0x0B,0x2B,0x2D,0x62,0x7C,0xA5,0xC1,0xDE,0x7B,0x92,0x0B,0x5C,0x38,0x5F,0xCD,
		0xAE,0x09,0xB2,0xEE,0x9D,0xA0,0xC3,0x21,0x4F,0x0D,0xBB,0xA4,0x9B,0xA1,0x2C,0x30,
		0xEC,0xC3,0xF0,0x63,0x7E,0x1E,0xCA,0x78,0x00,0xEC,0xD7,0x71,0x6B,0x05,0x2A,0xC2,
		0x57,0xF7,0x3E,0x60,0x45,0xB4,0x5D,0xD4,0x62,0xBD,0x75,0x75,0xBD,0x50,0x92,0xE5,
		0x98,0x26,0x3D,0x0A,0x24,0xC7,0x30,0x35,0xC4,0x17,0x9E,0x13,0xE4,0x82,0xB7,0x2F,
		0x08,0x9B,0x57,0x8B,0x8D,0x70,0xCF,0x4A,0xCB,0xBC,0x67,0x52,0x87,0xBA,0x00,0x1F,
		0x46,0x88,0x3E,0x2E,0x0E,0x0B,0x8B,0x53,0xF7,0x3E,0x02,0x86,0x75,0xC8,0xC0,0x15,
		0x73,0x61,0x59,0x0F,0xB9,0xCD,0x1B,0xEC,0x6F,0x6C,0x7A,0x6E,0xD7,0x0B,0x05,0xF7,
		0x05,0x8A,0xDC,0x2F,0xCE,0x3C,0xE6,0x85,0xA5,0x47,0xE1,0xCA,0x42,0x91,0x37,0x97,
		0x76,0x17,0x8A,0xBD,0xBB,0x55,0x8B,0x27,0x8A,0x85,0x92,0x3F,0x07,0x67,0xA1,0x64,
		0xF4,0x13,0xD7,0x8B,0x7E,0x62,0xEA,0x0B,0x6C,0xE9,0x7D,0x03,0x58,0x84,0xCF,0x85,
		0x1F,0x2F,0xE5,0x0E,0x00,0x00,0x00,0x00,0x49,0x45,0x4E,0x44,0xAE,0x42,0x60,0x82,
		0x00,
		0x04,0x41,0x42,0x43,0x44,
		0xDA,0xDD,0xE5,0x14,

		/* PropertyPage_LotInfo.Lot_IsOnline packet */
		0x27,0x34,
		0x00,0x00,0x00,0x38,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x26,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0x8A,0xFA,0x57,0xBF,
		0x69,0x6D,0x11,0x83,
		0x00, /* 0 for offline */
		0x00,

		/* PropertyPage_LotInfo.Lot_LeaderID packet */
		0x27,0x34,
		0x00,0x00,0x00,0x3B,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x29,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0xA3,0x93,0xEB,0x4A,
		0x69,0x6D,0x11,0x89,
		0x00,0x00,0x05,0x39, /* 1337 */
		0x00,

		/* PropertyPage_LotInfo.Lot_Name packet */
		0x27,0x34,
		0x00,0x00,0x00,0x40,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x2E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0xA9,0x89,0x07,0x2A,
		0x89,0x6D,0x16,0x88,
		0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x4C,0x6F,0x74, /* "JollyLot" */
		0x00,

		/* PropertyPage_LotInfo.Lot_Description packet */
		0x27,0x34,
		0x00,0x00,0x00,0x40,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x2E,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0xDA,0x9D,0xDE,0x47,
		0x89,0x6D,0x16,0x88,
		0x08,0x57,0x65,0x6C,0x63,0x6F,0x6D,0x65,0x21, /* "Welcome!" */
		0x00,

		/* PropertyPage_LotInfo.Lot_Price packet */
		0x27,0x34,
		0x00,0x00,0x00,0x3B,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x29,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0xEC,0x8D,0x5C,0x5C,
		0x69,0x6D,0x11,0x89,
		0x00,0x00,0x50,0x91, /* $20,625 */
		0x00,

		/* PropertyPage_LotInfo.Lot_Category packet */
		0x27,0x34,
		0x00,0x00,0x00,0x38,
		0xFE,0xED,0xF0,0x0D,
		0x48,0x6B,0x3F,0x7E,
		0x00,0x00,0x00,0x26,
		0x09,0x73,0x60,0x27,
		0x0F,0xE8,0x80,0x3B,
		0xA9,0x73,0x60,0xC5,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x03,
		0x7A,0x6C,0xEC,0xEE,
		0x00,0xB8,0x00,0xD5,
		0xFE,0x9E,0x1B,0x08,
		0xC9,0x76,0x08,0x7C,
		0x01, /* 1: Money category */
		0x00
	};

	printf("Reached client_handle_property_page_request.\n");
	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void client_handle_data_service_wrapper_pdu(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	uint32_t msgid, topicid;

	if (voltron_size < 39)
		return;

	msgid = READ32BE(voltron_data+31);
	topicid = READ32BE(voltron_data+35);

	if (msgid == 0x09C83484) {
		printf("client_handle_data_service_wrapper_pdu: Received subscribe request for topic 0x%08X\n", topicid);
		switch (topicid) {
		case 0xA46E47DC: client_handle_my_avatar_request(client); break;
		case 0xD042E9D6: client_handle_sim_page_main_request(client); break;
		case 0x9062B390: client_handle_thumbnail_avatar_request(client); break;
		case 0xE4E9B25D: client_handle_current_city_request(client); break;
		case 0x486B3F7E: client_handle_property_page_request(client); break;
		}
	} else if (msgid == 0x29C8348F) {
		printf("client_handle_data_service_wrapper_pdu: Received unsubscribe request for topic 0x%08X\n", topicid);
	}
}

static void client_handle_lot_entry_request_pdu(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	static const uint8_t player_packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x98,0x00,0x00,0x00,

		/* UpdateRoomPDU */
		0x00,0x3F,
		0x00,0x00,0x00,0x98,
		0x00,0x00,0x00,0x01,
		0x01,
		0x80,0x00,0x00,0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x4C,0x6F,0x74,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x31,0x32,0x30,0x30,
		0x01,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x31,0x33,0x33,0x37,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x61,0x73,0x64,0x66,
		0x80,0x00,0x00,0x08,0x4A,0x6F,0x6C,0x6C,0x79,0x4C,0x6F,0x74,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x31,0x32,0x30,0x30,
		0x00,0x00,0x00,0x01,
		0x00,0x00,0x00,0x10,
		0x00,
		0x02,
		0x80,0x00,0x00,0x01,0x47,
		0x00,0x01,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x31,0x33,0x33,0x37,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x61,0x73,0x64,0x66,
		0x01,
		0x00,0x01,
		0x80,0x00,0x00,0x01,0x4A,
		0x80,0x00,0x00,0x01,0x4B,
		0x00,
		0x00,0x01,
		0x80,0x00,0x00,0x01,0x4C,
		0x80,0x00,0x00,0x01,0x4D,
		0x00,
		0x00,0xB8,0x00,0xD5,
		0x00,0xB8,0x00,0xD5,
		0x00,0xB8,0x00,0xD5
	};

	static const uint8_t roomserver_packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x55,0x00,0x00,0x00,

		/* 0xACDC4FF2 */
		0x27,0x37,
		0x00,0x00,0x00,0x55,
		0xFE,0xED,0xF0,0x0D,
		0x00,0x00,0x00,0x04,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x3B,
		0x80,0x00,0x00,0x3B,
		0xAC,0xDC,0x4F,0xF2,
		0x00,0x00,0x00,0x3B,
		0x12,0x51,0x94,0xE5,
		0x19,0x50,0x02,0x23,
		0xFE,0xED,0xF0,0x0D,
		0xFF,
		0xAC,0xDC,0x4F,0xF2,
		0x00,0x00,0x05,0x39,
		0xDA,0xDD,0xE5,0x12,
		0xDA,0xDD,0xE5,0x13,
		0xDB,0xB9,0x12,0x6C,
		0x00,
		0x00,0x00,0x00,0x04,
		0xA0,0xA1,0xA2,0xA3,
		0x04,0x41,0x42,0x43,0x44,
		0xDA,0xDD,0xE5,0x14
	};

	printf("Reached client_handle_lot_entry_request_pdu.\n");
	bufferevent_write(player.bev, player_packet_data, sizeof(player_packet_data));
	bufferevent_write(roomserver.bev, roomserver_packet_data, sizeof(roomserver_packet_data));
}

static void send_0ac11f1e(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xFF,0xFF,0xFF,0xFF,
		0xF6,0x03,0x00,0x00,

		/* 0x0AC11F1E packet */
		0x27,0x37,
		0x00,0x00,0x03,0xF6,
		0xFE,0xED,0xF0,0x0D,
		0x00,0x00,0x00,0x04,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x03,0xDC,
		0x80,0x00,0x03,0xDC,
		0x0A,0xC1,0x1F,0x1E,
		0x00,0x00,0x03,0xDC,
		0xC9,0x2B,0x16,0x1D,
		0x1D,0x18,0x40,0x01,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,
		0x0A,0xC1,0x1F,0x1E,
		0x00,
		0x00,0x00,0x03,0xBA,
		/* The following 0x0AC11F1E body was generated using the function
		** TSOSimulatorClientD_base+0x13581 in TSO N&I, which saves the avatar to
		** avatar1337.dat. (To call the function, pass ecx=cTSONeighborhood,
		** arg1=cTSONeighbor, arg2=1337.) */
		0x39,0x05,0x00,0x00,0x00,0xAF,0x03,0x00,0x00,0x01,0x00,0x00,0x00,0x39,0x05,0x00,
		0x00,0x01,0x00,0x00,0x00,0x64,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x13,0x12,0x15,0x14,0x11,
		0x10,0x00,0x00,0x00,0x00,0x1B,0x1A,0x00,0x00,0x19,0x18,0x17,0x16,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xD7,0x1E,0x47,0x8D,0x7F,0xC4,0x9F,
		0xE7,0x0F,0x56,0xB7,0xFB,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xBC,0xBB,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,
		0x00,0x00,0x00,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,
		0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,
		0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,
		0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,
		0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,
		0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,0x00,0xC8,0x42,0x00,
		0x00,0xC8,0x42,0x09,0x00,0x39,0x05,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x4D,0x4C,
		0x4B,0x4A,0xFF,0xFF,0xAF,0x7F,0xFF,0xFF,0xFF,0xFF,0x00,0x5B,0x5A,0x59,0x58,0x63,
		0x62,0x61,0x60,0x5F,0x5E,0x5D,0x5C,0x00,0x51,0x50,0x4F,0x4E,0x49,0x48,0x47,0x46,
		0x57,0x56,0x55,0x54,0x07,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
		0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x42,0x6D,0x6F,0xA9,
		0x0D,0x00,0x00,0x00,0xB7,0x02,0x00,0x00,0x4C,0x04,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x02,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x42,0x6D,0x6F,0xA9,0x0D,0x00,0x00,0x00,
		0x4A,0x02,0x00,0x00,0xE8,0x03,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x08,0x00,0x00,0x00,0x42,0x6D,0x6F,0xA9,0x0D,0x00,0x00,0x00,0xB6,0x02,0x00,0x00,
		0xB0,0x04,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x77,0x76,0x75,0x74,
		0x00,0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x22,0x00,0x00,0x00,0x05,0x61,0x64,0x75,0x6C,0x74,0x00,0x12,
		0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x32,0x34,0x41,0x30,0x30,0x30,0x30,0x30,0x30,
		0x30,0x44,0x00,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x33,0x41,0x31,0x30,0x30,
		0x30,0x30,0x30,0x30,0x30,0x44,0x00,0x04,0x48,0x45,0x41,0x44,0x00,0x03,0x54,0x6F,
		0x70,0x00,0x06,0x52,0x5F,0x48,0x41,0x4E,0x44,0x00,0x04,0x50,0x61,0x6C,0x6D,0x00,
		0x00,0x00,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x32,0x42,0x36,0x30,0x30,0x30,
		0x30,0x30,0x30,0x30,0x44,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x6D,0x61,0x6C,
		0x65,0x00,0x02,0x32,0x37,0x00,0x03,0x6C,0x67,0x74,0x00,0x12,0x30,0x78,0x30,0x30,
		0x30,0x30,0x30,0x32,0x34,0x45,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x44,0x00,0x12,
		0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x32,0x42,0x37,0x30,0x30,0x30,0x30,0x30,0x30,
		0x30,0x44,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x12,0x30,0x78,
		0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
		0x00,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
		0x30,0x30,0x30,0x30,0x00,0x12,0x30,0x78,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
		0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x12,0x30,0x78,0x30,0x30,0x30,0x30,
		0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x08,0x4A,0x6F,
		0x6C,0x6C,0x79,0x53,0x69,0x6D,0x01,0x42,0x10,0x00,0x01
	};

	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void send_ambience(struct Client *client)
{
	static const uint8_t packet_data[] = {
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0xED,0x00,0x00,0x00, /* hex: 4f+4f+4f= ed */

		/* 0x0A8DCC52 packet */
		0x27,0x37,
		0x00,0x00,0x00,0x4F,
		0xFE,0xED,0xF0,0x0D,
		0x00,0x00,0x00,0x04,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x35,
		0x80,0x00,0x00,0x35,
		0x0A,0x8D,0xCC,0x52,
		0x00,0x00,0x00,0x35,
		0xC9,0x2B,0x16,0x1D,
		0x1D,0x18,0x40,0x01,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,
		0x0A,0x8D,0xCC,0x52,
		0x00,
		0x00,0x00,0x00,0x13,
		0xA0,0xA1,
		0xA9,0xC1,0x0B,0xBE, /* 0xBE0BC1A9: Ocean */
		0x01,0x00,0x00,0x00, /* Setting: 1 for on */
		0xE5,0xDD,0xDA,0x10,
		0x00,
		0xDD,0xCC,0xBB,0xAA,
		0x01,

		/* 0x0A8DCC52 packet */
		0x27,0x37,
		0x00,0x00,0x00,0x4F,
		0xFE,0xED,0xF0,0x0D,
		0x00,0x00,0x00,0x04,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x35,
		0x80,0x00,0x00,0x35,
		0x0A,0x8D,0xCC,0x52,
		0x00,0x00,0x00,0x35,
		0xC9,0x2B,0x16,0x1D,
		0x1D,0x18,0x40,0x01,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,
		0x0A,0x8D,0xCC,0x52,
		0x00,
		0x00,0x00,0x00,0x13,
		0xA0,0xA1,
		0x2D,0xBB,0x19,0xBE, /* 0xBE19BB2D: SeaBirds */
		0x01,0x00,0x00,0x00, /* Setting: 1 for on */
		0xE5,0xDD,0xDA,0x10,
		0x00,
		0xDD,0xCC,0xBB,0xAA,
		0x01,

		/* 0x1E04C15A (kAudioRadioSyncSound) packet */
		0x27,0x37,
		0x00,0x00,0x00,0x4F,
		0xFE,0xED,0xF0,0x0D,
		0x00,0x00,0x00,0x04,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x35,
		0x80,0x00,0x00,0x35,
		0x1E,0x04,0xC1,0x5A,
		0x00,0x00,0x00,0x35,
		0xC9,0x2B,0x16,0x1D,
		0x1D,0x18,0x40,0x01,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,
		0x1E,0x04,0xC1,0x5A,
		0x00,
		0x00,0x00,0x00,0x13,
		0xA0,0xA1,
		0x4B,0x52,0x4F,0x43, /* KROC */
		0xD0,0x6B,0xF2,0x1D, /* rock2_1df26bd0.mp3 */
		0xE5,0xDD,0xDA,0x10, /* Unknown */
		0x00,
		0xDD,0xCC,0xBB,0xAA,
		0x01,
	};

	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

/*
** client_handle_net_message_pdu:
** In response to cTSONetMessagePDU, forward it to the other party (if that
** party has joined the lot).
** We define the roomserver to have successfully joined the lot once we have
** sent it the HouseData packet.
** We define the player to have successfully joined the lot once the roomserver
** has sent the JoinHouseResponse packet to the player.
**
** In addition, once the roomserver sends the HouseData packet to the player,
** send the 0x0AC11F1E packet to both the roomserver and player simultaneously.
*/
static void client_handle_net_message_pdu(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	struct Client *dest_client = client->is_roomserver ? &player : &roomserver;
	uint32_t flags, recipient, msgid;
	uint8_t aries_header[12] = {0};

	if (voltron_size < 38)
		return;

	flags = READ32BE(voltron_data+10);
	recipient = READ32BE(voltron_data+14);
	msgid = READ32BE(voltron_data+26);
	printf("Reached client_handle_net_message_pdu. flags=%u,recipient=%u,msgid=%08X\n",
		(unsigned)flags, (unsigned)recipient, (unsigned)msgid);

	if (!dest_client->is_joined) {
		if (flags == 1 && recipient == dest_client->avatarid && msgid == 0x3BFC2808)
			dest_client->is_joined = 1;
		else
			return;
	}

	printf("Forwarding the packet.\n");

	/* Update the SendingAvatarID field and then forward the packet to the other party. */
	WRITE32BE(voltron_data+6, client->avatarid);
	WRITE32LE(aries_header+8, voltron_size);
	bufferevent_write(dest_client->bev, aries_header, 12);
	bufferevent_write(dest_client->bev, voltron_data, voltron_size);

	/* If the roomserver is sending the HouseData packet to the player,
	** send 0x0AC11F1E to both parties simultaneously.
	** TODO: In theory, this may cause a desync if there are more kServerTickConfirmationMsgs
	** in the incoming buffer from the HouseSimServer that we haven't retrieved yet. An ideal
	** solution would involve the HouseSimServer sending the 0AC11F1E packet, which requires
	** the HouseSimServer knowing the avatar data. */
	if (flags == 1 && recipient == dest_client->avatarid && msgid == 0x9B7ED631) {
		send_0ac11f1e(&roomserver);
		send_0ac11f1e(&player);

		send_ambience(&player);
	}
}

static void client_handle_chat_msg_pdu(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	uint8_t aries_header[12] = {0};

	printf("Reached client_handle_chat_msg_pdu.\n");
	WRITE32LE(aries_header+8, voltron_size);
	bufferevent_write(roomserver.bev, aries_header, 12);
	bufferevent_write(roomserver.bev, voltron_data, voltron_size);
	bufferevent_write(player.bev, aries_header, 12);
	bufferevent_write(player.bev, voltron_data, voltron_size);
}

static void handle_voltron_packet(struct Client *client, uint8_t *voltron_data, unsigned voltron_size)
{
	uint16_t type = READ16BE(voltron_data);

	printf("Received 0x%04X packet from %s.\n", (unsigned)type, client->name);

	fprintf(server.logfp, "\nReceived %u bytes from %s:\n", voltron_size, client->name);
	fwrite(voltron_data, 1, voltron_size, server.logfp);

	switch (type) {
	case 0x2725: client_handle_house_sim_constraints_pdu(client, voltron_data, voltron_size); break;
	case 0x2712: client_handle_db_request_wrapper_pdu(client, voltron_data, voltron_size); break;
	case 0x2734: client_handle_data_service_wrapper_pdu(client, voltron_data, voltron_size); break;
	case 0x2719: client_handle_lot_entry_request_pdu(client, voltron_data, voltron_size); break;
	case 0x2737: client_handle_net_message_pdu(client, voltron_data, voltron_size); break;
	case 0x0009: client_handle_chat_msg_pdu(client, voltron_data, voltron_size); break;
	/* TODO: In response to SplitBufferPDU etc., fail (or warn) with "Error: unsupported pdu". */
	}
}

static void roomserver_handle_connection_established(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x28,0x00,0x00,0x00,

		/* HostOnlinePDU */
		0x00,0x1E,
		0x00,0x00,0x00,0x0C,
		0x00,0x00,
		0x7F,0xFF,0x7F,0xFF,

		/* UpdatePlayerPDU */
		0x00,0x3D,
		0x00,0x00,0x00,0x1C,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x31,0x32,0x30,0x30, /* "??1200" */
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x61,0x73,0x64,0x66, /* "??asdf" */
		0x41,
		0x01
	};

	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void send_time(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x31,0x00,0x00,0x00,

		/* kServerTickConfirmationMsg */
		0x27,0x12,
		0x00,0x00,0x00,0x31,
		0xFE,0xED,0xF0,0x0D,
		0x80,0x00,0x00,0x00,
		0x80,0x00,0x00,0x00,
		0x00,
		0x00,
		0x00,0x00,0x00,0x19,
		0x12,0x51,0x94,0xE5,
		0xFF,0xFF,0xFF,0xFF,
		0xFE,0xED,0xF0,0x0D,
		0x07,
		0x3B,0xFC,0x28,0x08,
		0x00,0x00,0x00,0x00,
		0x00,0x00,0x09,0x60
	};

	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
}

static void player_handle_connection_established(struct Client *client)
{
	static const uint8_t packet_data[] = {
		/* Aries header */
		0x00,0x00,0x00,0x00,
		0xA1,0xA2,0xA3,0xA4,
		0x28,0x00,0x00,0x00,

		/* HostOnlinePDU */
		0x00,0x1E,
		0x00,0x00,0x00,0x0C,
		0x00,0x00,
		0x7F,0xFF,0x7F,0xFF,

		/* UpdatePlayerPDU */
		0x00,0x3D,
		0x00,0x00,0x00,0x1C,
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x31,0x33,0x33,0x37, /* "??1337" */
		0x80,0x00,0x00,0x06,0x3F,0x3F,0x61,0x73,0x64,0x66, /* "??asdf" */
		0x41,
		0x01
	};

	bufferevent_write(client->bev, packet_data, sizeof(packet_data));
	send_time(client);
}

/*
** ssl_readcb
** Retrieve and parse the next Aries packet if it's available,
** or do nothing if it has not completely arrived yet.
*/
static void ssl_readcb(struct bufferevent *bev, void *arg)
{
	static uint8_t packet_data[MAX_ARIES_PACKET_SIZE];
	struct Client *client = (struct Client *)arg;
	struct evbuffer *in = bufferevent_get_input(bev);
	size_t len = evbuffer_get_length(in);
	uint32_t packet_type, payload_size;
	uint32_t packet_size, position;

	if (evbuffer_copyout(in, packet_data, 12) != 12)
		return; /* we need more data before we can parse this packet */

	packet_type = READ32LE(packet_data);
	payload_size = READ32LE(packet_data+8);
	if (payload_size > MAX_ARIES_PAYLOAD_SIZE) {
		fprintf(stderr, "error: invalid Aries payload size %u\n", payload_size);
		exit(EXIT_FAILURE);
	}

	packet_size = 12+payload_size;
	if (len < packet_size)
		return; /* need more data */

	evbuffer_remove(in, packet_data, packet_size);

	if (packet_type != 0)
		return;

	position = 12;
	while (packet_size - position >= 6) {
		uint32_t voltron_size = READ32BE(packet_data+position+2);
		if (voltron_size < 6 || voltron_size > packet_size - position) {
			fprintf(stderr, "error: invalid voltron packet size %u\n", voltron_size);
			exit(EXIT_FAILURE);
		}

		handle_voltron_packet(client, packet_data+position, voltron_size);
		position += voltron_size;
	}
}

static void ssl_eventcb(struct bufferevent *bev, short events, void *arg)
{
	struct Client *client = (struct Client*)arg;

	if (events != BEV_EVENT_CONNECTED) {
		fprintf(stderr, "error: received socket error %d from %s\n", (int)events,
			client->name);
		exit(EXIT_FAILURE);
	}
}

static void ssl_acceptcb(struct evconnlistener *serv, int sock, struct sockaddr *sa, int sa_len, void *arg)
{
	struct Client *client = (struct Client *)arg;
	struct event_base *evbase = evconnlistener_get_base(serv);
	int value = 1;

	if (client->is_connected) {
		fprintf(stderr, "note: refusing new connection on port %d as %s has already connected\n",
			client->is_roomserver ? 49101 : 49100, client->name);
		close(sock);
		return;
	}

	setsockopt(sock, SOL_SOCKET, SO_KEEPALIVE, (char*)&value, sizeof(value));
	setsockopt(sock, IPPROTO_TCP, TCP_NODELAY, (char*)&value, sizeof(value));

	client->ctx = SSL_new(server.ctx);
	if (!client->ctx) {
		fprintf(stderr, "error: SSL_new for %s failed: %s\n", client->name,
			ERR_error_string(ERR_get_error(), NULL));
		exit(EXIT_FAILURE);
	}

	client->bev = bufferevent_openssl_socket_new(evbase, sock, client->ctx,
		BUFFEREVENT_SSL_ACCEPTING, 0);
	if (!client->bev) {
		fprintf(stderr, "error: bufferevent_openssl_socket_new for %s failed\n",
			client->name);
		exit(EXIT_FAILURE);
	}

	bufferevent_setcb(client->bev, ssl_readcb, NULL, ssl_eventcb, client);
	bufferevent_enable(client->bev, EV_READ|EV_WRITE);

	client->is_connected = 1;

	if (roomserver.is_connected && player.is_connected) {
		printf("Both parties have connected. (2/2)\n");
		roomserver_handle_connection_established(&roomserver);
		player_handle_connection_established(&player);
	} else {
		printf("The %s has connected. (1/2)\n", client->name);
	}
}

static SSL_CTX *evssl_init(void)
{
	SSL_CTX *server_ctx;

	SSL_library_init();
	SSL_load_error_strings();
	OpenSSL_add_all_algorithms();
	ERR_load_crypto_strings();
	OPENSSL_no_config();

	server_ctx = SSL_CTX_new(SSLv23_server_method());
	if (!server_ctx) {
		fprintf(stderr, "error: SSL_CTX_new failed: %s\n",
			ERR_error_string(ERR_get_error(), NULL));
		exit(EXIT_FAILURE);
	}

	SSL_CTX_set_options(server_ctx, SSL_OP_NO_SSLv2 | SSL_OP_NO_SSLv3);

	if (SSL_CTX_use_certificate_chain_file(server_ctx, "cert.pem") != 1) {
		fprintf(stderr, "error: SSL_CTX_use_certificate_chain_file failed: %s\n",
			ERR_error_string(ERR_get_error(), NULL));
		exit(EXIT_FAILURE);
	}

	if (SSL_CTX_use_PrivateKey_file(server_ctx, "key.pem", SSL_FILETYPE_PEM) != 1) {
		fprintf(stderr, "error: SSL_CTX_use_PrivateKey_file failed: %s\n",
			ERR_error_string(ERR_get_error(), NULL));
		exit(EXIT_FAILURE);
	}

	if (SSL_CTX_check_private_key(server_ctx) != 1) {
		fprintf(stderr, "error: SSL_CTX_use_PrivateKey_file failed: %s\n",
			ERR_error_string(ERR_get_error(), NULL));
		exit(EXIT_FAILURE);
	}

	return server_ctx;
}

int main(int argc, char *argv[])
{
	struct event_base *evbase;
	struct sockaddr_in sin;
	struct evconnlistener *roomserver_listener;
	struct evconnlistener *player_listener;

#ifdef _WIN32
	if (WSAStartup(MAKEWORD(2, 2), &wsaData) != 0) {
		fprintf(stderr, "error: WSAStartup failed\n");
		return EXIT_FAILURE;
	}
#endif

	server.logfp = fopen("log.dat", "wb");
	if (!server.logfp) {
		fprintf(stderr, "error: failed to open log.dat for writing\n");
		return EXIT_FAILURE;
	}

	setbuf(server.logfp, NULL);

	server.ctx = evssl_init();
	roomserver.name = "room server";
	roomserver.avatarid = 0xfeedf00d;
	roomserver.is_roomserver = 1;
	player.name = "lot owner";
	player.avatarid = 1337;

	evbase = event_base_new();
	if (!evbase) {
		fprintf(stderr, "error: event_base_new failed\n");
		exit(EXIT_FAILURE);
	}

	memset(&sin, 0, sizeof(sin));
	sin.sin_family = AF_INET;
	sin.sin_port = htons(49101);
	sin.sin_addr.s_addr = INADDR_ANY;
	roomserver_listener = evconnlistener_new_bind(evbase, ssl_acceptcb, &roomserver,
		LEV_OPT_REUSEABLE, 1024, (struct sockaddr *)&sin, sizeof(sin));
	if (!roomserver_listener) {
		fprintf(stderr, "error: evconnlistener_new_bind on port %d failed\n", 49101);
		exit(EXIT_FAILURE);
	}

	memset(&sin, 0, sizeof(sin));
	sin.sin_family = AF_INET;
	sin.sin_port = htons(49100);
	sin.sin_addr.s_addr = INADDR_ANY;
	player_listener = evconnlistener_new_bind(evbase, ssl_acceptcb, &player,
		LEV_OPT_REUSEABLE, 1024, (struct sockaddr *)&sin, sizeof(sin));
	if (!player_listener) {
		fprintf(stderr, "error: evconnlistener_new_bind on port %d failed\n", 49100);
		exit(EXIT_FAILURE);
	}

	printf("Waiting for connections from the room server (port 49101) and the lot owner (port 49100). (0/2)\n");

	event_base_loop(evbase, 0);

	return EXIT_SUCCESS;
}
